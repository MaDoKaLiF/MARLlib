{"episode_reward_max": 27.272145630233624, "episode_reward_min": -79.3149430479535, "episode_reward_mean": -17.06856648309239, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -56.81825200128704, "policy_agent_": -36.9346984626787}, "policy_reward_max": {"policy_adversary_": -5.192015069185295, "policy_agent_": 38.62121922596059}, "policy_reward_mean": {"policy_adversary_": -27.536732732933277, "policy_agent_": 5.234083124920442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.3149430479535, 9.491148934999124, 0.32501864827307525, 3.5044466805850734, -11.866947773581748, -1.6295532832843853, -5.06004370064843, 3.0924092816817215, 17.792735887606433, -8.439668285617287, -54.407639068439565, -5.671944098637514, -11.857753840689218, 1.9129993845393822, -55.784860121801444, 4.974118582318695, -27.3993050393782, 6.984529679409159, -1.684951099157507, -6.429666398043047, -58.57353868477997, 8.957958299245664, -29.928698656760496, 27.272145630233624, -14.221045804112169, -34.53155478057325, -15.842523290119964, -47.46785227085817, -3.9628353047480633, -15.5824453459871, -29.053772061898158, -22.207537318470003, -8.814563929398883, 7.84175059454831, 9.389782912527238, -0.5467010683730198, 15.511681913899286, -11.274048381180682, -26.66190876635121, -62.99759149942556, -23.515464109004096, -22.478902629294044, -20.75282827723924, -21.442760626689992, -60.39264938596833, 26.02014063135105, 9.507196948994107, -58.68147360812001, -35.99277687252193, -3.5697611038022083, -14.447245620964123, -27.243667386482585, -1.423600940823502, -30.24860876832423, -68.48599923644709, 3.625471162970973, 14.625042070604227, -7.797127041633801, -1.850943750346413, 21.295242353040777, -20.330446461552217, 13.597832621648777, -29.952302729576868, 13.19881755322579, -58.028453534035506, -24.876423960429815, -46.15843967200726, -31.499062960975618, -31.414405183642966, -20.57329342824559, -28.222208611897496, 0.21971057347790968, 20.999995252277394, -32.21329613364072, -60.97733947699936, -37.46077803043263, -37.593650530497804, 12.741703085020728, -48.31716269459978, -5.422486685083205, -27.246906293188815, 7.491960959407434, 21.449225755880093, 4.7731456104486885, 20.80858586465992, -11.071359198052322, 6.647915939218847, -17.37946675225557, -12.024032790675108, -68.13723996828897, -18.50562275253559, -21.746478360227222, -24.68775811768758, 16.822062545915163, -13.001948027081273, -3.2009988910468357, -21.44935125791103, -13.03193026870302, 8.190778288650522, 14.549370778772454, -24.195354378906213, -54.98353082217198, 2.098464255303596, -10.645697058630946, -42.22986721556305, -15.352051058186623, -53.90330051514827, -41.292770917425464, -38.82697679521487, 18.9196635177767, -31.193813077076538, -61.58507099308678, -35.74976896415016, 1.5480770066808442, -31.225490082119244, -7.856656983932206, -39.924592500510464, -35.740055907602425, -5.67133776085096, -5.881640590674883, -0.2185802776218163, -16.312465021864575, -4.123016552000699, -16.74358241276093, -76.02256640910997, -62.69118730184684, -18.17485606699895, -16.352864328363665], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.445546122596123, -41.83436000569591, -56.77812661572947, -12.124570252402203, -17.640236700494242, -17.096254904372167, -39.34110594200268, -32.695473481889245, -33.459719450217456, -17.964817048935753, -17.394179561367288, -28.22560116260028, -28.6474029683366, -48.23936752612054, -11.310143659327451, -50.195136775155405, -37.61342909061672, -33.824704779506, -25.45471783018246, -19.058914383505787, -10.204816503424249, -22.25356523224505, -32.79436864644297, -41.87291223350794, -22.901785722920813, -26.454269940529, -14.7879616723658, -33.86698165756907, -31.83226191470464, -29.206702161314837, -30.89593364562222, -8.355153199340302, -55.41746386916066, -52.625807235921506, -48.88278709351654, -34.101815244375445, -35.637360230805605, -26.852338300077633, -27.06549399538013, -14.265522366467247, -23.738372874792173, -32.01395850295147, -8.41109602648132, -18.958171782036523, -11.487694765219864, -51.222297820570105, -36.787750091658495, -14.10315552412385, -15.181206645848293, -27.76543701537778, -21.751246328060116, -40.43676926898841, -40.99755214456419, -19.817870849909006, -13.112106801599703, -15.124784425107322, -32.12808856243868, -32.87457217185424, -22.86542963800054, -36.738250758548205, -25.893083021000724, -22.78808649668524, -7.0372185951270145, -32.43288994926069, -21.206295078350824, -24.68131482022106, -11.460581475150564, -18.049737515390042, -14.112000557974516, -5.192015069185295, -29.173611400435554, -29.918800905290716, -49.5528210462577, -10.06810174121753, -11.825128179068267, -34.58752655946836, -21.409520839444497, -37.55108463714914, -7.686958470882582, -32.94276630633142, -12.680814516016383, -49.056400431202135, -38.89131788050873, -42.675444514392375, -38.130685717155046, -26.08429973254981, -34.123870117663586, -16.746935873964826, -25.00032689434339, -23.786975520455908, -16.0032570974588, -18.605469416912293, -9.942306504330695, -37.36529078130593, -36.16260882949837, -31.460913152118895, -38.55467404326698, -56.81825200128704, -38.340895466339546, -54.21020977550673, -40.14647834747804, -7.891560048292328, -47.03381406864153, -11.852484114196773, -10.58674030031367, -47.59611190312833, -16.428218900558313, -36.192062406579396, -33.07954071136834, -35.18510974954186, -22.97623277426182, -11.254894840824631, -25.612375302359904, -35.268193465733674, -15.116487888259892, -18.407397060069865, -29.328620055393937, -12.263498650403776, -54.346914395565285, -32.961121314888736, -27.644858902894892, -20.32965964866334, -19.824192077023397, -15.358493324921668, -36.71099189077395, -10.22344655823142, -31.963364501299466, -36.7735145587464], "policy_policy_agent__reward": [-36.9346984626787, -36.9346984626787, 25.662754470347515, 25.662754470347515, 28.551572632001278, 28.551572632001278, 7.814508466493637, 7.814508466493637, 2.886644463456243, 2.886644463456243, 7.733350810543893, 7.733350810543893, 17.14053112067712, 17.14053112067712, 17.893941381785478, 17.893941381785478, 25.626227668911948, 25.626227668911948, 4.762574381659235, 4.762574381659235, -18.50672975353615, -18.50672975353615, 11.276828531981378, 11.276828531981378, 8.394824563823686, 8.394824563823686, 25.076183455329968, 25.076183455329968, -22.237358231236986, -22.237358231236986, 27.584627678737053, 27.584627678737053, 5.107062025619258, 5.107062025619258, 20.404617229457575, 20.404617229457575, 11.884883365512472, 11.884883365512472, 6.314623992731368, 6.314623992731368, -24.184361090677854, -24.184361090677854, 15.605761765745356, 15.605761765745356, 1.4328349948412389, 1.4328349948412389, 34.572528931870785, 34.572528931870785, 4.3403699594043195, 4.3403699594043195, -4.038642420022121, -4.038642420022121, -0.5272808088770806, -0.5272808088770806, -6.800435306644536, -6.800435306644536, 13.93471330497829, 13.93471330497829, 6.812128407663867, 6.812128407663867, 0.9210807918620318, 0.9210807918620318, -6.92619205956485, -6.92619205956485, 23.30144996988089, 23.30144996988089, 30.233778915234904, 30.233778915234904, 29.136285003021882, 29.136285003021882, 16.777557088001213, 16.777557088001213, 25.57452107235244, 25.57452107235244, 7.7891449594484765, 7.7891449594484765, 0.20179261451446218, 0.20179261451446218, -24.366034566479158, -24.366034566479158, 0.11145438289403387, 0.11145438289403387, 4.767527936828714, 4.767527936828714, -6.1708661253789545, -6.1708661253789545, -1.2422944223267336, -1.2422944223267336, -24.45247731037423, -24.45247731037423, 38.62121922596059, 38.62121922596059, 23.1474735203263, 23.1474735203263, -22.289159041998083, -22.289159041998083, -10.405785113336808, -10.405785113336808, 12.097837955787792, 12.097837955787792, 3.6520003535479995, 3.6520003535479995, 6.5965509412529055, 6.5965509412529055, 19.786975601870342, 19.786975601870342, -5.215368959207618, -5.215368959207618, -27.686946217423703, -27.686946217423703, 9.375127794039146, 9.375127794039146, 23.376565316521447, 23.376565316521447, 12.53872256511022, 12.53872256511022, 10.507242943827062, 10.507242943827062, 29.016746555794487, 29.016746555794487, 2.7813182797242497, 2.7813182797242497, 18.19295955916701, 18.19295955916701, -11.457542067224926, -11.457542067224926, 22.815853751243242, 22.815853751243242, -18.411079227842357, -18.411079227842357, -0.09755457010437685, -0.09755457010437685, -17.34892909842835, -17.34892909842835, -6.72466272279278, -6.72466272279278, -8.65120231283422, -8.65120231283422, -7.690639179530149, -7.690639179530149, 0.4757013942690309, 0.4757013942690309, 15.06925573938432, 15.06925573938432, 35.276408149267546, 35.276408149267546, -11.072597196211596, -11.072597196211596, -24.576105648965548, -24.576105648965548, -1.4366257354821304, -1.4366257354821304, -8.092064845526657, -8.092064845526657, 25.14639386108493, 25.14639386108493, -20.315102111858604, -20.315102111858604, 13.76013981062411, 13.76013981062411, -7.283045888586217, -7.283045888586217, 28.274180695304786, 28.274180695304786, 30.17027181819441, 30.17027181819441, 23.724295062420538, 23.724295062420538, 29.469635790907486, 29.469635790907486, 7.506470267248743, 7.506470267248743, 20.38589302844122, 20.38589302844122, -0.31626543914537353, -0.31626543914537353, 6.488147051834144, 6.488147051834144, -22.175132223916535, -22.175132223916535, -1.2511828275384005, -1.2511828275384005, -1.570504471657462, -1.570504471657462, -7.372725806678448, -7.372725806678448, 27.093676663610545, 27.093676663610545, 11.580330401208544, 11.580330401208544, 14.129957130536033, 14.129957130536033, 8.552661392677974, 8.552661392677974, 21.89316086629201, 21.89316086629201, 23.265836877495023, 23.265836877495023, 34.3797902771396, 34.3797902771396, 7.975561984285921, 7.975561984285921, -23.54598538693983, -23.54598538693983, 24.56613916197258, 24.56613916197258, 0.6033935277829112, 0.6033935277829112, -15.8215634576247, -15.8215634576247, 16.122030422470846, 16.122030422470846, -18.737540807294963, -18.737540807294963, -2.5503542554230383, -2.5503542554230383, -2.873718041923277, -2.873718041923277, 27.052386633659275, 27.052386633659275, -4.108790151407359, -4.108790151407359, -25.16508807613107, -25.16508807613107, -5.068696830895128, -5.068696830895128, 18.408135236207254, 18.408135236207254, -8.054501096929677, -8.054501096929677, 5.275370038068829, 5.275370038068829, -5.297986222558265, -5.297986222558265, -11.73827862859933, -11.73827862859933, 24.337788317357166, 24.337788317357166, 13.539740362106928, 13.539740362106928, 13.713139312636539, 13.713139312636539, 2.0085973133993775, 2.0085973133993775, 7.850587762511349, 7.850587762511349, -0.6925445439196298, -0.6925445439196298, -19.655787259168022, -19.655787259168022, -26.23387037180772, -26.23387037180772, 6.894254217150256, 6.894254217150256, 10.21032511519137, 10.21032511519137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5295741412834019, "mean_inference_ms": 4.727705088826651, "mean_action_processing_ms": 0.18082533505364382, "mean_env_wait_ms": 0.9016119216018003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 3200, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"sample_time_ms": 20920.657, "sample_throughput": 152.959, "load_time_ms": 99.099, "load_throughput": 32290.967, "learn_time_ms": 682.521, "learn_throughput": 4688.498, "update_time_ms": 14.959}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7623.0693359375, "policy_entropy": 5150.177001953125, "policy_loss": 0.08570628240704536, "vf_loss": 160788.9921875}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24013.33203125, "policy_entropy": 5150.19921875, "policy_loss": 0.04744185879826546, "vf_loss": 462353.5}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3200, "num_agent_steps_sampled": 9600, "num_steps_trained": 3200, "num_agent_steps_trained": 9600}, "done": false, "episodes_total": 128, "training_iteration": 1, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-03-18", "timestamp": 1712764998, "time_this_iter_s": 21.58357000350952, "time_total_s": 21.58357000350952, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000025685519D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 21.58357000350952, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.422580645161283, "ram_util_percent": 93.88709677419354}}
{"episode_reward_max": 50.008257100470146, "episode_reward_min": -81.94263596312089, "episode_reward_mean": -12.849079534778646, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -69.51206022494443, "policy_agent_": -33.99313393172558}, "policy_reward_max": {"policy_adversary_": -8.201074443415221, "policy_agent_": 56.26368330298041}, "policy_reward_mean": {"policy_adversary_": -28.387364708759684, "policy_agent_": 7.769142586990521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.405028907414292, -1.1068443503361265, -4.065004075742913, -37.15012535112126, 2.9477916558410264, 8.689352822219574, -9.381354603739702, -14.14246775123317, -63.37080537872609, -50.950975065270185, -42.4610819785469, -6.189204270428615, -18.99358876300327, -10.209867776936102, -61.51823306700873, -32.915276272911186, 2.1229158803839625, -11.978680682679784, 5.200742090422713, 27.111320242360414, -24.809003198585376, -16.096251794688044, -48.942341262518724, 7.237340495105746, 15.916899035017757, -20.552899058288173, 3.1807907431809355, 0.6890115190252128, 7.778687005379112, -60.683438837107914, -11.190267926028657, 12.765038040029227, -33.02505343441305, 19.514343420541568, -36.49123906488418, -2.6073227658604106, -24.009531665681077, 2.683492575596533, -7.2012333325644455, 17.781147377940304, 13.178867821458567, -22.533975846234743, -20.165266597330795, -8.798062835123549, -1.1420148902065446, -42.86632969069123, -9.72283498685859, 10.904910660686742, -22.63929956079211, -19.145347057154872, -10.044079915993862, 6.691187309141204, -3.0198629397660257, -9.637857113007502, -14.782245294953057, 10.787704356120296, -5.063410020350665, -16.406486158281357, 11.488326888048478, -56.02532682240579, -60.00841217490945, -0.7745952146624653, -6.127874854054008, 10.425318600814435, -20.765520616936232, 20.338429853760122, -16.872214850208305, -9.313611688629301, -7.126725081786304, -31.884705535129097, -21.23124034670951, -11.194601805384956, 18.38135210115979, 1.9644822524362806, 14.1737587879533, -35.330085830719746, -30.220901650370365, -64.03925202740596, -25.73402283730758, -19.15648062275017, -26.71383442907906, -29.468848446235842, -1.1482062665835553, -10.761253374385841, 5.737884271305898, 18.848437123133085, 1.7833842812694933, 8.500708502307734, -44.459473614888616, 16.382634520311868, 39.0845663901201, -12.971292575709468, -25.506416298940444, -36.818194997561854, -42.28712219522153, -36.472311095753795, -32.91158683578714, -6.492022260821919, -7.947973892069279, 50.008257100470146, 13.267465206230732, -35.75662021048735, 3.9465685299385536, 24.713859163384637, -8.645254260185908, 19.561552844247178, -5.983242206347196, -33.222626571879516, -25.362443921314338, -1.9319656334796824, 29.746290779730316, 7.3158935997168655, -42.55250993172635, -32.7657484848124, -24.763218632632228, 19.010127120501178, -19.129120617617964, -16.110554094631535, -16.90007738105708, -35.0516292066875, -18.55631950306438, -64.06870002157953, -81.94263596312089, -10.68177238178484, 9.14766054369703, -0.9003871522552447, -76.41798022904572, -28.57963158890267], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-27.502170744329746, -17.46313684299203, -27.011853293201703, -10.297336518504807, -35.73915422112353, -42.4327833502977, -43.8502564926423, -54.100108084248, -20.385746736119692, -19.895367283001406, -8.833712823807044, -8.384620989603825, -30.30046184490657, -16.552010235149545, -22.12503665490336, -40.72190288306261, -23.929813325109425, -35.21102435739947, -52.30044078147228, -43.51364755275928, -26.427739601929638, -22.507581526171357, -13.427991414019226, -30.842942017976895, -43.52893497673673, -22.932548364343447, -32.01585478965997, -42.317621424570966, -15.928945804838584, -26.433463695209994, -30.20483184729607, -38.6113410606548, -12.18869142436492, -33.97182436362203, -27.90336700223512, -25.19278591236093, -48.02574311739685, -18.542867892109964, -19.374026413820857, -37.76292929364961, -50.76661020359484, -25.494992606290882, -8.405117743291246, -25.23854364118192, -35.48762723277728, -11.98830347663607, -30.56278284326232, -19.876639875305766, -52.3041841299681, -52.23741818348669, -8.693979775816004, -11.706415589501603, -24.330530467895098, -43.399565710840356, -13.784751005654174, -35.334476477925996, -9.818248526754264, -38.96689203230376, -47.00027403834594, -23.241193086773546, -22.05078397428, -17.695008474402016, -31.580013097616185, -32.582788856288936, -23.708532400696722, -46.34599318490438, -30.364842729427536, -24.83150333876722, -17.749429621773434, -24.400013429590874, -23.419141681350474, -29.090611311646246, -69.51206022494443, -14.592108563359032, -29.669649373493264, -37.08397924503175, -45.31051116682111, -8.201074443415221, -13.397932998687134, -30.891707884978004, -31.75707535352397, -17.828962515554167, -52.86253494618966, -23.7699526925263, -23.017166099490098, -45.853632603191436, -16.11037725286536, -62.364674383545264, -13.450474696385896, -29.17433595214658, -57.22420096608699, -10.234988661229075, -13.820129470364138, -9.521488392282311, -27.236683511629582, -17.34982657617359, -13.4218963586918, -52.81772987108925, -43.32535647715741, -62.51910950549069, -43.808120279953705, -14.284575469281336, -42.27425684016374, -35.73728604359546, -18.397340902077612, -34.771494082317595, -29.505614186513377, -13.85978683173425, -11.141163184880838, -16.64979160710054, -48.254343534329664, -30.978504370953104, -13.492084898830111, -27.03453440880763, -17.21306424687459, -39.15985604349167, -10.812483175593824, -38.01837740514813, -25.200093182900282, -31.91232991248837, -10.646552072956675, -18.587207663792142, -13.956368099669723, -16.861557325598667, -47.980307313948366, -21.28811481698394, -11.84662249773982, -36.44140643121898], "policy_policy_agent__reward": [14.453599825872018, 14.453599825872018, 8.178146246327952, 8.178146246327952, 11.473424608729392, 11.473424608729392, -13.426394416308236, -13.426394416308236, 19.343472938482282, 19.343472938482282, 25.561068086258633, 25.561068086258633, 17.2344509444513, 17.2344509444513, 19.97882016650741, 19.97882016650741, -21.49252932130318, -21.49252932130318, -15.527803891134395, -15.527803891134395, -16.81368457736993, -16.81368457736993, 1.097708359587604, 1.097708359587604, 5.653436540951651, 5.653436540951651, 3.1710712291067216, 3.1710712291067216, -19.696598206052666, -19.696598206052666, 3.903313305075703, 3.903313305075703, 13.02636460274669, 13.02636460274669, 11.616171837359836, 11.616171837359836, 28.7505914359475, 28.7505914359475, 35.31248389755985, 35.31248389755985, 0.8093682016721269, 0.8093682016721269, 3.2056648657416558, 3.2056648657416558, -17.757174924249746, -17.757174924249746, 19.040141256541315, 19.040141256541315, 29.722917005877243, 29.722917005877243, 1.1898246530276333, 1.1898246530276333, 17.598322766420456, 17.598322766420456, 21.50331647179809, 21.50331647179809, 11.853816405108848, 11.853816405108848, -17.12498757094894, -17.12498757094894, 9.507281960633703, 9.507281960633703, 25.688189550342017, 25.688189550342017, -10.418181005024064, -10.418181005024064, 26.743083892081795, 26.743083892081795, -4.293936031324524, -4.293936031324524, 11.292731573250256, 11.292731573250256, 12.008105725857884, 12.008105725857884, 10.613180233853248, 10.613180233853248, 6.086396540628207, 6.086396540628207, 27.772038335794957, 27.772038335794957, 31.972739012526702, 31.972739012526702, 1.4805083800280747, 1.4805083800280747, -5.8800744270197765, -5.8800744270197765, 8.220240403029187, 8.220240403029187, 17.172806171285366, 17.172806171285366, -15.439013107027563, -15.439013107027563, 10.419973928201866, 10.419973928201866, 15.390775267996256, 15.390775267996256, 14.832442284587989, 14.832442284587989, 16.546035563165905, 16.546035563165905, -0.6750500700889273, -0.6750500700889273, 9.1988014493214, 9.1988014493214, 10.655333764064538, 10.655333764064538, 16.88085429891643, 16.88085429891643, -0.4987471446494427, -0.4987471446494427, 23.06109041702315, 23.06109041702315, 2.377419253201797, 2.377419253201797, 11.2802029370112, 11.2802029370112, 29.24430046319721, 29.24430046319721, -16.392066867816112, -16.392066867816112, -18.978814100314715, -18.978814100314715, 8.460206629869775, 8.460206629869775, 12.726069121781089, 12.726069121781089, 21.50405372855169, 21.50405372855169, 1.4715058918802466, 1.4715058918802466, 33.34221151933226, 33.34221151933226, 6.746313939609613, 6.746313939609613, 7.7589458250689605, 7.7589458250689605, 5.311352269993566, 5.311352269993566, -3.74234605276912, -3.74234605276912, 1.0939506673204762, 1.0939506673204762, 8.94800475313065, 8.94800475313065, 43.946706163052106, 43.946706163052106, 8.278295407897657, 8.278295407897657, 21.921704080723284, 21.921704080723284, 0.8769467071560013, 0.8769467071560013, 7.544804758225379, 7.544804758225379, -27.91908879199537, -27.91908879199537, -6.168044919310233, -6.168044919310233, 5.867613631113917, 5.867613631113917, 2.521620462222451, 2.521620462222451, -5.819942965340831, -5.819942965340831, 25.857164339803052, 25.857164339803052, 6.504349659070227, 6.504349659070227, 14.377525185398, 14.377525185398, 32.35103486316227, 32.35103486316227, 8.946880767067427, 8.946880767067427, 35.4326914429265, 35.4326914429265, -15.50449945925135, -15.50449945925135, 22.778485236229226, 22.778485236229226, 48.15438367810354, 48.15438367810354, -1.3681519572401948, -1.3681519572401948, -5.8431434142881535, -5.8431434142881535, -13.64835330263978, -13.64835330263978, -7.525219341795972, -7.525219341795972, -9.561242259790097, -9.561242259790097, -9.74484523854767, -9.74484523854767, 23.16285380513367, 23.16285380513367, 17.688691292544068, 17.688691292544068, 56.26368330298041, 56.26368330298041, 28.53779274309221, 28.53779274309221, -10.736022370603004, -10.736022370603004, 23.110412685051145, 23.110412685051145, 30.225572603490047, 30.225572603490047, 4.876043320945851, 4.876043320945851, 27.16652346328239, 27.16652346328239, 11.76118599008309, 11.76118599008309, -9.681419870072634, -9.681419870072634, -7.110640368216749, -7.110640368216749, 7.358912986810427, 7.358912986810427, 39.00031715702999, 39.00031715702999, 19.147198985334988, 19.147198985334988, -14.530212516448119, -14.530212516448119, -2.8656070380023833, -2.8656070380023833, -3.77507719287882, -3.77507719287882, 29.084991581996423, 29.084991581996423, -4.1583187210120665, -4.1583187210120665, 10.953911655258299, 10.953911655258299, 4.150007900921608, 4.150007900921608, -1.5696496470995633, -1.5696496470995633, -3.954883715053845, -3.954883715053845, -22.74074617889371, -22.74074617889371, -33.99313393172558, -33.99313393172558, 3.0898924719069107, 3.0898924719069107, 28.5639839288227, 28.5639839288227, 10.193863832364348, 10.193863832364348, -32.285678865652976, -32.285678865652976, 3.930887421158155, 3.930887421158155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5317852843871175, "mean_inference_ms": 4.69574688412476, "mean_action_processing_ms": 0.17303400646055364, "mean_env_wait_ms": 0.9027098775040338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 6400, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"sample_time_ms": 21328.18, "sample_throughput": 150.036, "load_time_ms": 103.406, "load_throughput": 30945.851, "learn_time_ms": 729.223, "learn_throughput": 4388.234, "update_time_ms": 12.983}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7834.20556640625, "policy_entropy": 5149.90966796875, "policy_loss": 0.03944291174411774, "vf_loss": 175667.9296875}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25050.85546875, "policy_entropy": 5150.134765625, "policy_loss": -1.1202315092086792, "vf_loss": 504400.15625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6400, "num_agent_steps_sampled": 19200, "num_steps_trained": 6400, "num_agent_steps_trained": 19200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 256, "training_iteration": 2, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-03-40", "timestamp": 1712765020, "time_this_iter_s": 21.776516437530518, "time_total_s": 43.36008644104004, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256854D5790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 43.36008644104004, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.290000000000003, "ram_util_percent": 93.70333333333332}}
{"episode_reward_max": 44.43357837551394, "episode_reward_min": -72.37649213210021, "episode_reward_mean": -11.06315274595471, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -71.15450518749722, "policy_agent_": -32.82517518867793}, "policy_reward_max": {"policy_adversary_": -5.0192374458722435, "policy_agent_": 55.029045304436664}, "policy_reward_mean": {"policy_adversary_": -30.84131169660837, "policy_agent_": 9.889079475326827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.797494479327018, 12.815980403165288, 6.425525594355301, 9.827250637087603, -19.68866580858937, -4.2812479101295065, 17.149634434694423, 1.0896785352974874, -42.90942120804853, 25.611240860566856, -21.954477358292827, -40.989567625996344, -36.481191776070794, -36.962631294734464, -22.266018225436575, -3.0601077008822823, -70.63427263367909, -44.58170473559914, -1.898825243439319, -32.105019654652224, -21.68107756291788, -56.37857618335002, -18.733594113861265, 11.701357067865032, -31.84701679122752, -64.68604920434325, 14.813623591488358, -15.092467410377822, -21.9711376424197, -47.993015326587205, -2.507987586400578, -20.95949632944272, 38.9035854213761, -13.166378434445122, -15.851200133580418, -16.61277661473683, -19.50323429931174, 18.478947097615464, -17.222099978194322, -30.443227509554347, 1.4311276695958586, 8.395264253984822, 9.259491613421622, -40.64850039307907, -0.9829867422623002, 12.438307241837755, -11.565455270610418, -12.673331419588582, -6.787088600911172, 6.791840444892776, -50.13377844870471, -14.633104287754946, -37.17329159085284, -0.7910993972765419, -11.715270653742769, 8.794694601383803, -13.079498496335267, -6.276355828655573, -41.05577006403059, -7.306777328398001, -36.839481572928925, -20.613017968696695, -23.03757775895975, -46.500946803773644, -8.526027115706457, 9.441184950633987, -1.9079989845670478, 19.769591399824634, 23.862862331915956, -13.037237718122697, -16.765260647500522, -30.54154378968566, 31.876340231200228, -1.305203670599436, -33.24232598409973, -13.827379737394983, -36.06021048187247, -17.858980817767538, 30.67097584275257, -1.2957669970953332, -17.413800066263192, -37.19221546572198, -32.85560512267709, -17.293092284782514, -6.952488920623518, 25.818318058351732, -33.71516718882986, -5.264759702848772, 44.43357837551394, -8.209762409732887, 13.06232693367932, -33.39292478756034, -2.4097202852679644, -57.45386024774668, -56.05370444675329, 23.494995787861413, -21.30969064559796, -19.23483826304084, -13.087447786722523, 18.82312572070176, 17.140393650214065, -61.51719501318565, 24.096986292959034, 32.365262620405986, -72.37649213210021, 12.141616593317634, -9.014213900483174, -22.978026800635632, -6.557022415894243, 3.765742279181306, 14.477994246252106, 18.06680529657864, -13.724825149377002, 1.1968125924169084, -17.1811077748144, 3.221063086825624, 2.79285977275098, -21.61509748680837, -9.892968898396296, -19.40830894408919, -8.667332585623804, -8.006318931482355, 12.773240189047362, -1.4835988602655243, -21.36206019464612, 11.076103651815348, -12.720027569013824, 22.405642772555012], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-22.98536077261689, -50.2289358284592, -34.934528437604534, -51.23169998364413, -25.628544157198093, -23.808313583214343, -33.25029510335092, -50.58828707905162, -28.48027718376781, -43.83742717470515, -30.720475745194705, -11.97115471177628, -17.274321276960222, -37.34940276142682, -52.922362555606725, -20.61764083035206, -10.168189964387027, -16.585711108285643, -38.03655964425072, -22.727978117558294, -32.14465851521776, -41.7513104842821, -27.334582518253598, -47.725055727140315, -23.584404454288325, -9.323461158290225, -34.24195801704552, -34.478417848829984, -18.35351088877999, -12.867858175442382, -34.30411510685663, -34.14387385362904, -71.15450518749722, -6.0107829662168735, -56.69893618689291, -16.30941180932083, -18.821627767273775, -25.03760304515495, -19.95489638123851, -33.08852063087861, -18.70922682067701, -22.14319226821082, -45.591889270314525, -31.437147650874728, -40.74212565660979, -35.37312612632217, -44.88038027066137, -35.429243815434795, -31.933088939524744, -33.503619197402536, -10.363083165981406, -21.939089449670533, -26.06937312185577, -28.764605560860353, -15.581672571003297, -34.02013183738375, -45.83058056643935, -27.80286868384405, -15.337785836973962, -33.69470439622937, -12.763769708638922, -25.97253315646045, -17.388495162456216, -13.357463668526197, -16.605732442027357, -53.8768289020104, -35.57047961631563, -50.57213158707579, -51.53533012377591, -15.160961505237292, -33.51799040384707, -42.55932309938415, -66.37915213208832, -21.570923463362355, -35.187349995881156, -27.39926624199039, -35.051184417937606, -23.63362630102113, -43.18782638525142, -22.995586342220513, -5.0192374458722435, -23.607761702261275, -9.028244127527424, -21.126438021725978, -56.19238182577968, -52.40724093890054, -44.763982086377425, -23.708167844355007, -56.78838369641941, -30.175971004997614, -33.40930861825199, -29.6407016368534, -22.449016428374758, -14.786631189240502, -44.383961647129915, -46.83023425267924, -15.689117069352807, -19.356699093484252, -17.91246821913127, -27.836998077815267, -36.334807539890086, -11.760104824522493, -45.02500006366396, -51.101868436998686, -6.726141754744361, -26.094532542971947, -37.31595816611634, -50.64930334181235, -36.50334227155798, -30.885054736384728, -35.8691444641985, -62.95295699084213, -12.918786018134671, -19.442346454802582, -50.41410803281351, -28.54596021955646, -52.355392484257024, -23.233174533397193, -29.140917956865852, -16.7890756871436, -33.300004808238434, -27.697804689998975, -30.599533050501684, -27.56874526772452, -22.85682450382881, -25.102953162425738, -23.178435908721866, -34.10282772350313], "policy_policy_agent__reward": [1.5939331466449314, 1.5939331466449314, 31.522458115812253, 31.522458115812253, 20.680027015979917, 20.680027015979917, 30.529475310365854, 30.529475310365854, 2.9699391743043586, 2.9699391743043586, 9.763532836542419, 9.763532836542419, 25.199964769022678, 25.199964769022678, 25.83898280717455, 25.83898280717455, -7.21457201214035, -7.21457201214035, 34.724334017636, 34.724334017636, 4.382999193450945, 4.382999193450945, -14.509206457110034, -14.509206457110034, -9.603435249555274, -9.603435249555274, 0.19338573334617992, 0.19338573334617992, 15.328172165085075, 15.328172165085075, 8.778766564734887, 8.778766564734887, -30.233041334646014, -30.233041334646014, -13.997996813656751, -13.997996813656751, 18.0688672004057, 18.0688672004057, -4.68852076854694, -4.68852076854694, 5.23179047614994, 5.23179047614994, -7.313632849533969, -7.313632849533969, 4.300494202196162, 4.300494202196162, 29.71320639750267, 29.71320639750267, -4.131306168469601, -4.131306168469601, -27.68129402302651, -27.68129402302651, 24.52779080426695, 24.52779080426695, 9.692975219226089, 9.692975219226089, -1.8088133768198558, -1.8088133768198558, -17.562578575572417, -17.562578575572417, 15.898063760228023, 15.898063760228023, 6.592188762093142, 6.592188762093142, 55.029045304436664, 55.029045304436664, -3.5777977341141196, -3.5777977341141196, 20.42386802665624, 20.42386802665624, -0.15168240270800254, -0.15168240270800254, -0.34080326601898137, -0.34080326601898137, 21.758275071385206, 21.758275071385206, 1.3663982015220963, 1.3663982015220963, 1.3226465606621343, 1.3226465606621343, 10.070177245136433, 10.070177245136433, 15.269228261097815, 15.269228261097815, 27.425690441868078, 27.425690441868078, -4.6056763711021755, -4.6056763711021755, 19.879569457173744, 19.879569457173744, 23.905716684079966, 23.905716684079966, 16.657462500025478, 16.657462500025478, 11.377956197923101, 11.377956197923101, 12.573000169306786, 12.573000169306786, 20.14772982114766, 20.14772982114766, -19.88534764136165, -19.88534764136165, 3.652992580957788, 3.652992580957788, -5.551959234498537, -5.551959234498537, 13.986753081791903, 13.986753081791903, 1.9332009586302599, 1.9332009586302599, 21.407413219383773, 21.407413219383773, 16.37554103505205, 16.37554103505205, 10.763256427594243, 10.763256427594243, -12.858992113528323, -12.858992113528323, 13.193963533915687, 13.193963533915687, -12.037855932144996, -12.037855932144996, 2.679757593881879, 2.679757593881879, -2.8245412982517717, -2.8245412982517717, -16.57174156762372, -16.57174156762372, 4.039852663160451, 4.039852663160451, 31.659006926322185, 31.659006926322185, 16.831240315874293, 16.831240315874293, 35.170861493450204, 35.170861493450204, 37.69909622784594, 37.69909622784594, 1.0618618935573005, 1.0618618935573005, 8.376364878173264, 8.376364878173264, 6.008889654849255, 6.008889654849255, 49.12774618164428, 49.12774618164428, 10.13285989638146, 10.13285989638146, 0.972512005890718, 0.972512005890718, 6.785943252297702, 6.785943252297702, -0.5045130319674334, -0.5045130319674334, 2.8873227416267953, 2.8873227416267953, 36.929401114002005, 36.929401114002005, 10.84990967256259, 10.84990967256259, -6.197281310195472, -6.197281310195472, -6.79222688173036, -6.79222688173036, -11.913680497574827, -11.913680497574827, 1.9166728684717322, 1.9166728684717322, 24.61994645257808, 24.61994645257808, 39.112779498626146, 39.112779498626146, 5.524407448773788, 5.524407448773788, 9.221704070753118, 9.221704070753118, 50.610981035966674, 50.610981035966674, 10.983104297632364, 10.983104297632364, 23.235817775965657, 23.235817775965657, -1.87611157535347, -1.87611157535347, 10.019648071553394, 10.019648071553394, -21.333614529253087, -21.333614529253087, -5.834871399811691, -5.834871399811691, 35.16261502027032, 35.16261502027032, -2.8102867881225766, -2.8102867881225766, 0.06093041522170661, 0.06093041522170661, 2.4125102162043763, 2.4125102162043763, 23.330061899258514, 23.330061899258514, 26.737600595052072, 26.737600595052072, -24.878545094331585, -24.878545094331585, 34.56099317831149, 34.56099317831149, 41.73356552870233, 41.73356552870233, -32.82517518867793, -32.82517518867793, 19.11807456814479, 19.11807456814479, 14.150872132816582, 14.150872132816582, 13.835638270588353, 13.835638270588353, 14.973159927831869, 14.973159927831869, 17.325398507783017, 17.325398507783017, 25.17356935522531, 25.17356935522531, 40.50988114371039, 40.50988114371039, -0.40301956562116587, -0.40301956562116587, 10.319579523609743, 10.319579523609743, 16.61650012899955, 16.61650012899955, 15.88351165319104, 15.88351165319104, 27.574126128504, 27.574126128504, 0.809038523294413, 0.809038523294413, 9.623974529234781, 9.623974529234781, -1.3096166284727961, -1.3096166284727961, 12.316336111307315, 12.316336111307315, 9.845742879258308, 9.845742879258308, 21.686386619774527, 21.686386619774527, 13.0425732037295, 13.0425732037295, 0.7473821545913382, 0.7473821545913382, 18.089528407120547, 18.089528407120547, 5.229204169854018, 5.229204169854018, 28.25423524802907, 28.25423524802907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524574785775883, "mean_inference_ms": 4.560133924385916, "mean_action_processing_ms": 0.16136155030638238, "mean_env_wait_ms": 0.8805731338407206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"sample_time_ms": 20827.088, "sample_throughput": 153.646, "load_time_ms": 93.552, "load_throughput": 34205.622, "learn_time_ms": 692.776, "learn_throughput": 4619.097, "update_time_ms": 11.981}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10983.228515625, "policy_entropy": 5149.18701171875, "policy_loss": -0.693869486451149, "vf_loss": 200305.1328125}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28263.876953125, "policy_entropy": 5149.9599609375, "policy_loss": -0.8784728050231934, "vf_loss": 578206.75}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 28800, "num_steps_trained": 9600, "num_agent_steps_trained": 28800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 384, "training_iteration": 3, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-04-00", "timestamp": 1712765040, "time_this_iter_s": 19.59716296195984, "time_total_s": 62.95724940299988, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002568B3749D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 62.95724940299988, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.15555555555556, "ram_util_percent": 93.91851851851851}}
{"episode_reward_max": 41.00486685279029, "episode_reward_min": -79.72794863761868, "episode_reward_mean": -15.835979823363239, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -61.37196388114654, "policy_agent_": -36.740142595264906}, "policy_reward_max": {"policy_adversary_": -4.783805643827572, "policy_agent_": 50.27562663148529}, "policy_reward_mean": {"policy_adversary_": -26.33398945002093, "policy_agent_": 5.249004813328845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.46742445628752, -27.500920477219513, 1.0641627251004875, -14.825596714511986, 16.28446135879978, -3.0952852275342195, 9.126582348709407, -51.51123193246291, -13.196688908901116, 11.693471237955654, 5.471160080297748, -17.448291575105003, -24.912148126740657, -24.386295658032537, 6.644945517097861, -20.42377937441681, -26.552744148031973, -4.734618492040792, -1.4888293202218372, -78.26409083435739, -22.00661547461227, -3.5043720758769803, 8.939350311602041, -8.954103861461057, -2.6032077661508444, 5.960047203886208, 5.120358600207924, 0.2274189865345858, 5.609682182043006, -40.62989918994002, 8.589178991135269, -33.71360251853517, -43.25737384941942, -31.626499545829322, 20.891348973828755, 12.94185511468126, -24.732601871860478, -24.773130486620225, -14.78778388776593, 35.64116302496016, 11.052891670416557, -22.19803234580714, -31.09684562389218, -24.867139153914817, 4.6687078304113445, -3.29264811075736, -11.459608535185016, -17.577354839930027, -78.69887295426605, -1.375980134662722, -16.038327322226035, -20.121174949390976, -48.72485671174375, 21.683509055801853, -13.856170598693222, -30.73903653052141, -48.35303177941138, -13.039574322133777, -0.1628474286443513, 39.17928938182403, 0.022231708967566877, -63.65916520136852, 2.3823436106657185, -11.470352726786768, -4.662643593006914, -35.882002953020994, -19.810648351393592, -37.74465346654247, -35.068698272287044, 3.1512806070214063, 41.00486685279029, -26.21468539692229, -11.630517952915856, -19.11414222896003, -5.54709306410837, -42.785088302903326, -11.874125536391407, -13.467418170951852, -32.956522305959474, -24.235251070555048, -0.9928545082986311, 5.822133696210655, -40.40573615854292, -33.41287059181521, -30.878915161541062, -18.301564377531644, 5.396763967908091, -51.5143270263846, -7.324458071354806, -54.986930204909136, -27.00689158763859, -13.447897880740204, -73.07230805227812, -24.831753497702728, -20.78797208183133, 6.093134744830148, -23.084904872222648, -10.779279987660047, -33.47441743920159, -2.8019244987011054, -31.298894578956443, -5.47539022799182, -13.006280166360392, -21.23604766376913, -29.281908481864996, -4.4244045041466, -30.44734885735336, -30.525234081380646, -36.03293740357265, -29.65323869367917, 2.909119707154966, 11.49527028151361, -9.473308056992629, -79.72794863761868, -32.96617448034955, -24.418764155937026, -11.188280103940347, -14.611917974032208, 15.900517459464096, -0.9745197636868106, -38.35438088345904, -30.859740338043416, 12.549545411358697, -19.202952317592022, 16.490590832569964, 12.23158928686129, -27.03816439567741, -34.819902679156044], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.738274073760895, -22.2274319150903, -36.88859790473314, -6.810831750267694, -31.533002844743542, -18.939783402823494, -23.647054987885657, -17.359981613999246, -24.945468457705566, -26.478285293928362, -39.75022084181322, -36.36652193152115, -50.003440714440686, -19.940052320786346, -52.97454491457808, -32.524939334128135, -43.83675899984528, -23.248417395929337, -23.6070534641372, -4.783805643827572, -24.78052754198012, -34.84775041927934, -37.6377405970402, -29.403842083446833, -18.9425276123628, -19.49908572228483, -21.128912767355516, -19.260761268347434, -33.0475165463369, -30.680298994802257, -53.048231203927, -18.240694094988953, -18.006991452982085, -19.66073153365855, -45.04377819558776, -19.311659238656215, -25.445295295558285, -36.13413195353387, -7.844253461916447, -52.97237160797142, -38.076440665919776, -8.26366345572543, -19.95731767033986, -26.787740207925864, -35.03686477587154, -53.93997726689638, -45.107487567511896, -48.967214751319666, -28.643162563080743, -22.009527716922975, -36.865655502002994, -19.560532719094166, -13.75611332712725, -41.87085544956639, -20.636926115740202, -22.141601653894334, -28.119951960311848, -20.122063318774906, -34.24785554386519, -61.37196388114654, -13.518596534644853, -24.639112865128443, -30.01051613181753, -7.193528724291834, -24.748760616855456, -14.620379838415055, -40.0854106926872, -12.9628193233693, -23.43576955869625, -29.236861949342018, -51.88226494417355, -27.728980718294586, -13.490749059437896, -35.00509129022642, -35.605992266696006, -28.0519976087152, -33.93089730737062, -22.94166104372111, -7.2946772423460535, -27.53402524987922, -24.69599277342574, -26.603084208727697, -8.42890837579275, -15.717470862557255, -25.184575294843103, -16.776394605166377, -24.399329345634598, -24.49252710358758, -12.654106314806429, -39.17374726033844, -20.51961397759287, -16.52786786535162, -40.132991129981065, -27.161028566727495, -9.815706913950294, -19.362441291700588, -51.66269934463029, -21.107085692606688, -21.32373658039549, -42.87498287139257, -7.266787096572515, -5.351844757789728, -10.985200709404173, -24.082749237530322, -14.194328212700492, -23.6049751668329, -10.519149113061058, -16.347909251690854, -16.390917559613577, -16.849765064214854, -23.23312791461217, -37.261292877844426, -32.72947854326338, -30.389731425388828, -14.065542075407713, -33.70028791841233, -29.29499956764894, -28.505455494683368, -43.78326112633173, -38.023904962163634, -23.065476822142493, -11.997054120550143, -26.369826036438578, -8.74569767480634, -41.253214758083004, -33.586912599516786, -25.086761961143733, -7.508128698513707], "policy_policy_agent__reward": [-8.364575191263322, -8.364575191263322, -2.6367442810646065, -2.6367442810646065, 18.976380314916806, 18.976380314916806, -4.0073824821221455, -4.0073824821221455, 23.90873210177166, 23.90873210177166, 7.92224908764464, 7.92224908764464, 16.386818668297533, 16.386818668297533, -17.07562515923183, -17.07562515923183, 5.874389774402224, 5.874389774402224, 19.085878265942004, 19.085878265942004, 22.610690461055487, 22.610690461055487, 9.459115178208073, 9.459115178208073, 12.54564629385002, 12.54564629385002, -2.2231216686230946, -2.2231216686230946, 29.809745215837975, 29.809745215837975, 6.0505799798556605, 6.0505799798556605, 8.642007425906659, 8.642007425906659, 9.256899451944273, 9.256899451944273, 11.059112071957681, 11.059112071957681, -36.740142595264906, -36.740142595264906, 1.3869560336839262, 1.3869560336839262, 15.671689171701185, 15.671689171701185, 23.28854545432112, 23.28854545432112, 10.224869110992888, 10.224869110992888, 8.169659923105977, 8.169659923105977, 12.72956646308552, 12.72956646308552, 13.124635683781722, 13.124635683781722, 9.744090127441014, 9.744090127441014, 19.32859936418995, 19.32859936418995, -4.974800097568882, -4.974800097568882, 30.81870509753114, 30.81870509753114, -7.736454211773099, -7.736454211773099, -12.625191198218676, -12.625191198218676, -5.98288400608539, -5.98288400608539, 32.967563584708266, 32.967563584708266, 16.126757176668736, 16.126757176668736, 0.35634671184890176, 0.35634671184890176, 5.680500733456818, 5.680500733456818, -3.471765212924742, -3.471765212924742, 44.30676731646578, 44.30676731646578, 24.564666168168156, 24.564666168168156, -6.9671844450408535, -6.9671844450408535, -5.569763976776155, -5.569763976776155, 0.9603005270055199, 0.9603005270055199, 19.852786303141443, 19.852786303141443, 25.323664578069515, 25.323664578069515, 16.823939516163442, 16.823939516163442, 15.694929955694821, 15.694929955694821, -25.02785519559268, -25.02785519559268, 10.316773791130126, 10.316773791130126, 10.41366408988848, 10.41366408988848, -0.28032111514840374, -0.28032111514840374, -17.48437169230826, -17.48437169230826, 31.777182252684117, 31.777182252684117, 3.3903777585234844, 3.3903777585234844, -4.298717438313545, -4.298717438313545, -10.116539909549756, -10.116539909549756, 3.5412444983205655, 3.5412444983205655, 17.042504057610422, 17.042504057610422, 50.27562663148529, 50.27562663148529, 6.77041412180621, 6.77041412180621, -19.510026168120046, -19.510026168120046, 16.19642987124162, 16.19642987124162, -2.138412001247467, -2.138412001247467, 10.043058511924269, 10.043058511924269, -10.630811557302966, -10.630811557302966, 10.137381170646801, 10.137381170646801, -12.390917071586582, -12.390917071586582, -5.816464356795394, -5.816464356795394, 16.19407127818171, 16.19407127818171, 46.44356589848193, 46.44356589848193, 0.7571476606861474, 0.7571476606861474, 0.9301155532610206, 0.9301155532610206, 7.945474530633191, 7.945474530633191, 15.029449601293821, 15.029449601293821, -7.366545347094052, -7.366545347094052, 11.028385885489609, 11.028385885489609, 4.737121436384631, 4.737121436384631, -12.830922531806712, -12.830922531806712, 1.6493870896620833, 1.6493870896620833, 11.851569132563556, 11.851569132563556, 16.21260895246918, 16.21260895246918, -15.98841389137508, -15.98841389137508, -8.847699864628973, -8.847699864628973, -2.8471699333489786, -2.8471699333489786, -0.7625848861826369, -0.7625848861826369, 14.898046656771344, 14.898046656771344, -13.510899961398504, -13.510899961398504, 2.66482412172581, 2.66482412172581, -7.906591472285364, -7.906591472285364, -3.243638805022866, -3.243638805022866, 1.5399849923057096, 1.5399849923057096, -16.469658461148544, -16.469658461148544, 1.1646375345123843, 1.1646375345123843, -5.4861325839405195, -5.4861325839405195, 12.727788018265368, 12.727788018265368, 14.28889723620382, 14.28889723620382, 5.163902852473325, 5.163902852473325, -6.075340429403044, -6.075340429403044, 20.036529186345724, 20.036529186345724, -12.016053741191957, -12.016053741191957, -0.06177273510104622, -0.06177273510104622, -1.0105397284781086, -1.0105397284781086, 1.4233507868805961, 1.4233507868805961, -7.543790134582256, -7.543790134582256, 9.59028533134315, 9.59028533134315, -9.964099872146146, -9.964099872146146, -7.088662414844896, -7.088662414844896, -9.821009921979543, -9.821009921979543, -6.4017368147321605, -6.4017368147321605, 13.071123810883572, 13.071123810883572, 24.37828157967902, 24.37828157967902, 11.628085243135377, 11.628085243135377, -24.669108606114918, -24.669108606114918, -9.450316202470926, -9.450316202470926, 4.640761881237655, 4.640761881237655, 9.053359731854297, 9.053359731854297, 6.946768760325579, 6.946768760325579, 29.84188929289791, 29.84188929289791, 18.524692599238417, 18.524692599238417, -7.644452030658281, -7.644452030658281, -9.431343108746638, -9.431343108746638, 19.45968572389864, 19.45968572389864, -5.228627321392839, -5.228627321392839, 28.871902795326488, 28.871902795326488, 22.90925094318904, 22.90925094318904, -0.9757012172668371, -0.9757012172668371, -13.65588699032117, -13.65588699032117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5012823169971387, "mean_inference_ms": 4.3693133401047515, "mean_action_processing_ms": 0.15705867201432094, "mean_env_wait_ms": 0.8507591235936597, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12800, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"sample_time_ms": 20009.143, "sample_throughput": 159.927, "load_time_ms": 89.353, "load_throughput": 35813.001, "learn_time_ms": 669.712, "learn_throughput": 4778.175, "update_time_ms": 10.971}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6984.12890625, "policy_entropy": 5147.315185546875, "policy_loss": -0.8144363909959793, "vf_loss": 129100.9609375}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23492.5390625, "policy_entropy": 5149.6005859375, "policy_loss": -0.34147655963897705, "vf_loss": 415060.34375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12800, "num_agent_steps_sampled": 38400, "num_steps_trained": 12800, "num_agent_steps_trained": 38400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 512, "training_iteration": 4, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-04-17", "timestamp": 1712765057, "time_this_iter_s": 17.503730297088623, "time_total_s": 80.4609797000885, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256845DCB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 80.4609797000885, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.355999999999998, "ram_util_percent": 93.40400000000001}}
{"episode_reward_max": 40.26697447510733, "episode_reward_min": -68.33333332993224, "episode_reward_mean": -14.538999372303486, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -63.44862596307013, "policy_agent_": -27.534320426151297}, "policy_reward_max": {"policy_adversary_": -5.26475368801805, "policy_agent_": 49.28469668571181}, "policy_reward_mean": {"policy_adversary_": -28.264578189867592, "policy_agent_": 6.862789408782052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7433115720755255, -15.620537091613112, -15.946001621070447, -59.53182926710098, 23.16704772811439, -41.15699840494851, -41.37660411205995, 1.190972533883846, -28.097802204056883, 13.915301195570649, -20.87437613229828, -61.07488201391716, -28.566568846314162, 40.26697447510733, -17.184066433828374, -6.0379512066732675, -46.34835234238862, 15.492225771372212, -63.308764327537865, -6.495025613309505, -14.539636956265587, -2.862856119537877, -10.2800242721109, -27.862465236914606, 10.138676662946551, -37.30671762486227, -64.8622130442489, -19.5722593306363, -16.896673293804138, -57.508521294739175, -21.881345489998466, -12.752099713140336, -22.58016254286847, -42.86167676509608, -7.263057537338028, 11.454915254411276, 0.8075429062961752, 10.783061120763083, 21.722961381949993, 21.313502146379673, -28.586931591323328, 19.7854668098587, -12.791589983737211, -27.13915995750117, -38.22389445861087, -8.661801927072169, 10.976052951460314, -50.21588693647865, -9.622602512739974, 0.3395411986922009, -4.145101647049827, -30.49278173497082, -21.05168957118232, -8.323024076441126, -37.28491428564909, -35.76991467718732, -26.15733195252428, -47.0089799633611, -16.545859123190613, 12.914783776192303, -28.490148323289972, 7.352174077544057, -21.473246102818713, -30.059120610151858, 21.046385194716702, -10.573613982713145, -26.496392736161592, -8.868498857151934, -31.761670286924186, -17.410211274073966, -29.353218753175575, -3.683946243956944, -24.49274279097919, -15.774600682067994, -68.33333332993224, -0.1183042058268563, 14.120646069636924, -27.280084209405434, -16.48058405007038, -32.989761833629835, -26.44653880178886, -29.78771276566489, 24.036532076856076, 0.6456693783430707, -5.069925631348228, -43.57365543788433, -47.66037394555429, 20.102497437037883, -52.68861124547715, -12.87340216931922, -12.51839224873687, 7.277722426853112, -6.018650154463362, 6.534261301941854, 1.0041647814283654, -44.036432648325935, 29.501232452986066, -26.602276342955836, -8.80576766503647, 20.1379021582178, -3.042237655602558, -4.013175583941303, 1.7598019629277875, 36.42162758120659, 5.750051181721369, 1.2922792522860769, -8.31144418691225, -2.739645302159709, 10.93543296485104, -28.861589502846343, -14.4253603368525, -27.335833354639327, -14.59811070123761, 16.55945131975668, -36.27306035236227, -19.634392853324638, -67.87787454273163, -4.8542507475571135, -0.666273804800048, -6.597002371451745, -47.01633938675894, -50.600112980814174, 1.6297732733049362, -6.0104760528623675, 15.456467546697453, -40.4776954171859, -13.231083517975037, 5.876402784515473], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.369825620353264, -31.477167503934837, -39.554241231829444, -6.395393189095146, -43.01430955739588, -41.79373353475435, -30.412646164035028, -30.43670801197117, -10.754403187816655, -40.109364697682686, -20.714615728211335, -10.19623985851133, -11.791685224137973, -58.30241889631628, -36.24577266479543, -12.621249542130768, -8.385288309447082, -38.17221099663141, -29.87491050461569, -9.644884153293937, -14.047285034804089, -40.578623849689166, -35.59293442464022, -27.8316090922821, -37.220259378152946, -9.542631574263186, -30.96097732241426, -13.203160570029146, -21.40326055866866, -10.654549384749734, -29.914272863238505, -18.30909703511387, -55.94902556548144, -31.636814003376976, -43.72708893901382, -32.65692160077939, -35.923449794285446, -47.1157780087651, -32.231898652263475, -44.36728040542973, -19.226545140055997, -36.04381370604967, -15.000502304359667, -17.9554675426665, -31.164400335456694, -7.630319551136816, -32.348786174198445, -17.31128072223106, -27.22757552057585, -22.11552354021562, -46.0726441628382, -17.80944831707176, -34.94098245623843, -27.031886186799262, -5.26475368801805, -6.449604706883798, -15.659025267319572, -27.062023994373938, -38.027849822539785, -28.21188522672098, -21.80538625466395, -63.44862596307013, -40.741498289312155, -30.758904187613098, -48.818240131338904, -22.05415008978919, -10.959044439999284, -19.4184285863726, -11.736005721111336, -18.1565272678159, -15.98653334898608, -20.0276114263877, -13.277270064638886, -33.32368944805167, -24.88826484687164, -11.975224666789032, -30.893149757373887, -18.9069954908787, -17.90561720579943, -32.18001737243581, -29.108501626799782, -16.854983922201804, -43.888027664508456, -23.678901462387632, -35.38234049900032, -36.57687881425828, -9.472918469324624, -39.80196514295147, -25.039997074858515, -6.242268723655473, -44.904211286715196, -17.801993125859944, -40.88682164059157, -59.80444392500064, -24.10433588963471, -19.681145458048533, -56.86337803254753, -33.15535288137851, -46.50345870888271, -55.21018743301094, -25.498810421009708, -40.25110716462198, -33.693263565074155, -56.89782264917869, -29.610918881191694, -39.761099411681165, -28.855499676768314, -39.342105102170336, -49.56208099974775, -32.94742192091073, -10.225957895176602, -14.420192168633234, -17.85555744290401, -41.41501606055095, -20.900586805581767, -48.14348831085359, -12.809233690429021, -40.03083226492007, -43.53292289704253, -15.143438993282352, -16.764962345497366, -20.621648689976098, -16.824160778010402, -37.671433774481315, -38.973812487673925, -5.809466628150494, -27.85321261428934, -27.538353322177095], "policy_policy_agent__reward": [6.8132570241388715, 6.8132570241388715, 7.928315206160854, 7.928315206160854, 11.8041198053795, 11.8041198053795, -26.568218039002932, -26.568218039002932, 33.09067864275514, 33.09067864275514, 0.3183675649029132, 0.3183675649029132, -5.481978974012456, -5.481978974012456, 15.813840272927505, 15.813840272927505, -8.671699508120122, -8.671699508120122, 27.012332946626668, 27.012332946626668, -0.07988020204347118, -0.07988020204347118, -25.439321077702903, -25.439321077702903, -8.387441811088092, -8.387441811088092, 49.28469668571181, 49.28469668571181, 9.530853115483533, 9.530853115483533, 3.2916491677287505, 3.2916491677287505, -18.981532016470762, -18.981532016470762, 26.832218384001806, 26.832218384001806, -16.71692691146108, -16.71692691146108, 1.5749292699922166, 1.5749292699922166, -0.2461759607307551, -0.2461759607307551, 18.85788386507564, 18.85788386507564, 12.656455076264667, 12.656455076264667, -0.01542807231625809, -0.01542807231625809, 23.67946802054975, 23.67946802054975, -13.882043025299536, -13.882043025299536, -16.95061786091732, -16.95061786091732, -3.184549380303578, -3.184549380303578, 2.253293632432266, 2.253293632432266, -23.426985954994716, -23.426985954994716, 4.016463686620019, 4.016463686620019, 2.7784986609867683, 2.7784986609867683, 16.68443151130649, 16.68443151130649, -5.612431380859544, -5.612431380859544, 18.23201570083789, 18.23201570083789, 22.05591842759534, 22.05591842759534, 18.36549635029081, 18.36549635029081, 28.94941956476409, 28.94941956476409, 26.977430017106737, 26.977430017106737, 32.8403912759047, 32.8403912759047, -4.680193225633667, -4.680193225633667, 27.91464025795419, 27.91464025795419, 1.104456160311229, 1.104456160311229, -4.591846207417335, -4.591846207417335, -3.5297470615770883, -3.5297470615770883, -0.5157411879676757, -0.5157411879676757, 21.662419562829378, 21.662419562829378, -16.452303107123804, -16.452303107123804, 8.802486503917933, 8.802486503917933, 11.227532369453911, 11.227532369453911, 20.963771257894184, 20.963771257894184, -6.341666708949516, -6.341666708949516, 6.944646442528061, 6.944646442528061, 9.354431055179067, 9.354431055179067, -16.010080298815524, -16.010080298815524, -14.660154985151769, -14.660154985151769, -5.249153342602352, -5.249153342602352, -9.973477984493577, -9.973477984493577, 10.74099534967459, 10.74099534967459, 20.563334501456644, 20.563334501456644, -3.3423810343130103, -3.3423810343130103, 35.40040002030708, 35.40040002030708, 9.634126093246717, 9.634126093246717, 0.3498917887306221, 0.3498917887306221, 34.9323126630278, 34.9323126630278, 5.740268053538023, 5.740268053538023, -7.768674148081152, -7.768674148081152, 5.274964864610333, 5.274964864610333, -10.012832282906434, -10.012832282906434, 0.37315799687096285, 0.37315799687096285, -6.683342702094745, -6.683342702094745, 8.171832591215377, 8.171832591215377, -5.607736363170153, -5.607736363170153, 8.774544382991838, 8.774544382991838, -21.72253424153031, -21.72253424153031, 5.928460230481087, 5.928460230481087, 22.506897913505405, 22.506897913505405, -4.186544359263365, -4.186544359263365, 0.712516577864529, 0.712516577864529, -0.40487223059701405, -0.40487223059701405, 1.3309814125054567, 1.3309814125054567, -6.466364421731539, -6.466364421731539, 33.962279870682266, 33.962279870682266, 12.162285420365352, 12.162285420365352, 15.15620743382605, 15.15620743382605, -3.4983883118130246, -3.4983883118130246, -19.093727738114833, -19.093727738114833, 29.95223128999467, 29.95223128999467, -13.824307085309314, -13.824307085309314, -3.3155667228318744, -3.3155667228318744, 16.192909518989158, 16.192909518989158, 12.539857776356527, 12.539857776356527, 17.434085743064106, 17.434085743064106, 33.16935261347124, 33.16935261347124, 12.554250335531535, 12.554250335531535, -12.177643595138697, -12.177643595138697, 43.18230524276681, 43.18230524276681, 3.2765382692113305, 3.2765382692113305, 18.848845521923113, 18.848845521923113, 37.674044795614364, 37.674044795614364, 11.228286382703576, 11.228286382703576, 18.11896579034034, 18.11896579034034, 17.72653276400097, 17.72653276400097, 46.65972511519264, 46.65972511519264, 17.68048503145653, 17.68048503145653, 20.526689331983622, 20.526689331983622, 10.272027744928028, 10.272027744928028, 18.301229900005314, 18.301229900005314, 30.24875698229939, 30.24875698229939, 2.04291620903219, 2.04291620903219, -2.099701220837942, -2.099701220837942, -6.457820593003044, -6.457820593003044, 1.628723370833203, 1.628723370833203, 28.987233690153808, 28.987233690153808, -7.686236773390245, -7.686236773390245, 14.254547728764473, 14.254547728764473, -27.534320426151297, -27.534320426151297, 17.588290758681485, 17.588290758681485, 21.43332454612124, 21.43332454612124, 4.2732183109153015, 4.2732183109153015, -15.125688520630789, -15.125688520630789, -14.989232145419027, -14.989232145419027, 9.226967025657668, 9.226967025657668, 15.830478860809475, 15.830478860809475, 27.21514001718569, 27.21514001718569, -17.334114394517698, -17.334114394517698, 7.311064548157147, 7.311064548157147, 16.707378053346286, 16.707378053346286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4935793545564841, "mean_inference_ms": 4.297609247570372, "mean_action_processing_ms": 0.15190018541283493, "mean_env_wait_ms": 0.8385654360299916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 19687.911, "sample_throughput": 162.536, "load_time_ms": 87.24, "load_throughput": 36680.33, "learn_time_ms": 652.258, "learn_throughput": 4906.035, "update_time_ms": 10.971}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8264.2900390625, "policy_entropy": 5143.966552734375, "policy_loss": -0.3452477604150772, "vf_loss": 171866.125}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24858.1328125, "policy_entropy": 5148.955078125, "policy_loss": -0.43253347277641296, "vf_loss": 495610.25}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 48000, "num_steps_trained": 16000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 5, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-04-36", "timestamp": 1712765076, "time_this_iter_s": 18.34486222267151, "time_total_s": 98.80584192276001, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000025685436280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 98.80584192276001, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.700000000000003, "ram_util_percent": 93.48461538461538}}
{"episode_reward_max": 40.87546499206686, "episode_reward_min": -66.7468185984345, "episode_reward_mean": -12.633207189618224, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -60.89290586062125, "policy_agent_": -29.88407240028516}, "policy_reward_max": {"policy_adversary_": -4.066262078970584, "policy_agent_": 48.532268714375356}, "policy_reward_mean": {"policy_adversary_": -28.3167048535067, "policy_agent_": 7.841748831944238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.862596250135734, -26.12631193324919, -24.65766425883602, -17.18774385629258, 4.045744588076185, -63.83440687954092, -13.076256951273777, -4.373659852511188, -9.530664428268198, -15.830845099441275, -15.119657379458756, -25.03281771813578, -10.349364743826948, -42.862784294503186, 5.519221835398605, -28.97375969239374, -25.84613636570643, -29.168016429643018, -44.351607857189336, -49.00165908812052, -8.510316954387791, -38.405391600087185, -22.371183426315625, -22.085275258423962, 2.1794307560704214, 10.747726530031713, -59.87493969597531, -9.530710069674996, -13.580664463546674, -35.07035088617653, 11.076679181752, 17.364134269598217, 23.330994030088416, -47.685261351556285, 5.0535141677346385, -16.16701551539352, 5.656789261203714, -45.66820949489565, -3.047398087049898, 11.909426485725579, -3.255780674552647, -44.738516421350425, 4.498866014360473, -24.000021507382165, -7.515720976507939, -33.40898718845758, 7.082412910740786, -45.786637802094404, -27.868333810889933, 4.447190571034895, 23.407510695394784, -2.9220045512074, 32.65197707115924, -41.436671839545205, -59.32429831606547, 2.4823854010324866, -48.27949300502617, -4.260633028099303, 15.573187785200052, -3.8856629758643098, -27.832558644181397, -13.709104299504993, -48.95971466042076, -10.37126198234672, -6.032859350249076, -24.589349914799183, -5.825025872700206, -32.570158807350644, -13.85729535654668, -33.08660624634443, -18.64772453377518, 20.16587044168079, -10.86308948508659, -47.43655646086578, 40.87546499206686, -12.692784411801455, -34.21260229476268, -18.900803665002954, -32.67529123194099, -5.20128891479477, -26.689305101019745, 19.482355783101227, 15.811064186087634, -5.127977153079371, 3.540770822268481, 9.971215728996746, -1.3961114075886636, -20.380753001085083, -3.2800420169738898, -28.934077148806487, -24.330040928349, 3.2630653928419138, 0.4453678880804043, -32.358731621813554, -2.9763323590453963, -10.022153561600135, 14.655374856387773, -27.11272272730528, -41.03928306182547, 17.676695915822343, -10.678281044276831, -12.941370471371334, -9.74671356001903, -0.5138971049088885, -18.62160048897278, -13.24127491602801, -0.6569455260752146, -9.124832695570761, 5.165582334907868, -14.821625843190805, 16.5581892502702, -6.0444409164843265, -66.7468185984345, 12.2134528169906, -4.37455617702202, -11.598848367117808, 23.50850309341226, -9.957747483470136, -10.134226190728224, -21.78708153341034, -12.045182062899746, 25.975509633750924, 21.460957610355834, -6.182062624481101, -27.143247433662268, -11.553907217596661, -38.94568582201476, 1.9902317049983504], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-55.59687068890549, -26.65695089441743, -20.7979509607486, -10.284982807217808, -43.894589642502616, -4.066262078970584, -38.155123509348876, -21.996664088767222, -20.963349614321377, -12.237487385518117, -26.857400811400062, -21.17280584352974, -10.187229232739941, -21.70535320942208, -37.24478535700075, -17.411660281273996, -21.620788187982416, -15.637124693025925, -13.067924113520958, -25.552433196021877, -19.769823894245533, -8.021308085724662, -19.543719562545665, -16.59941939677342, -22.947273546465986, -53.9553168224259, -16.174932722171235, -22.507985408505526, -8.895927815681855, -28.6094963288369, -32.55940166380649, -37.40566676787708, -38.74009564335059, -9.814014368926662, -47.691083789621096, -26.166371623232166, -30.007135663090033, -10.81771630700325, -42.6616778838675, -24.099282957199968, -19.697038460315433, -7.271769703019742, -26.407949589756456, -37.238422443590316, -20.35874513535306, -19.249580390930294, -42.78463932556943, -5.9919448524139804, -28.47468386194711, -28.519381461515547, -41.72799940976031, -31.999010725150242, -49.441068934711524, -9.013076504287646, -27.738816094395638, -28.48616123890421, -15.015578446490881, -44.67975316711006, -47.47165352525513, -28.713107761289287, -9.775887139808319, -40.47940175422918, -31.869712872476132, -43.89657213199236, -17.89150792440949, -51.405377439645726, -19.36282701257067, -26.856638897584013, -10.06175268206477, -36.6004531822132, -22.636286770262288, -32.08833201583398, -35.05690537671399, -29.637521397853916, -56.18907243668384, -11.878323247167149, -16.4994505040457, -37.876534894436766, -26.38717549093051, -39.498096903412815, -12.375471951883526, -30.767359051073765, -34.25951339464008, -28.34710471600052, -31.29481524758288, -57.96172852571295, -48.34081199858965, -24.29587143667041, -19.158871265392577, -10.070087224248978, -32.66764878152509, -23.167149725690233, -17.43220080084363, -18.458635329780975, -42.558246218686044, -21.91448554698195, -55.53088300114428, -26.37531758811599, -10.265711220111104, -40.99850244829762, -51.31196977665681, -14.031956953721547, -25.86053085352963, -24.159868995797154, -60.89290586062125, -20.59972768471427, -41.65821324193442, -27.075517539453397, -29.260363764993315, -27.11401212172099, -47.13801471662358, -40.151196303020235, -16.383101213382737, -44.555583045661514, -45.13610663733919, -33.451018206631346, -39.56147281206809, -24.942387461247154, -42.237726896761515, -28.7107879416937, -12.466560907748468, -39.810300992966276, -40.62580806968357, -30.596927752443836, -34.73407626881337, -8.651795367487537, -28.942178146179966, -19.914098288902007], "policy_policy_agent__reward": [25.36713721938487, 25.36713721938487, 0.26531948058411536, 0.26531948058411536, -1.9298566490437095, -1.9298566490437095, -3.4513805245373907, -3.4513805245373907, 23.9701671152894, 23.9701671152894, -29.88407240028516, -29.88407240028516, 12.539433279037553, 12.539433279037553, 8.811502118128018, 8.811502118128018, 5.716342593026592, 5.716342593026592, -1.7966788569615797, -1.7966788569615797, 5.868871715970654, 5.868871715970654, -1.9300059373030218, -1.9300059373030218, -0.08106775554350215, -0.08106775554350215, -10.578715542540545, -10.578715542540545, 21.38200359619968, 21.38200359619968, -5.781049705559872, -5.781049705559872, -2.112674088862005, -2.112674088862005, -6.76544586830854, -6.76544586830854, -15.641841871834197, -15.641841871834197, -11.72461294604932, -11.72461294604932, 5.629753469928871, 5.629753469928871, -15.192041757181258, -15.192041757181258, -1.4137319318849793, -1.4137319318849793, -2.7429279308252696, -2.7429279308252696, 12.563352151268203, 12.563352151268203, 32.3515216762288, 32.3515216762288, -21.850003486902057, -21.850003486902057, 6.488637669415264, 6.488637669415264, -2.3423683239324093, -2.3423683239324093, -3.2304272786698154, -3.2304272786698154, 21.818040422779244, 21.818040422779244, 27.38490051873765, 27.38490051873765, 31.0355448367195, 31.0355448367195, -18.93562349131481, -18.93562349131481, 26.372298978677865, 26.372298978677865, 4.999678053919323, 4.999678053919323, 17.831962462146866, 17.831962462146866, -17.425246593946206, -17.425246593946206, 19.8071398984088, 19.8071398984088, 18.004354721462768, 18.004354721462768, 8.220628892881392, 8.220628892881392, -18.73337335916533, -18.73337335916533, 15.453407802058468, 15.453407802058468, 6.619200468104074, 6.619200468104074, 6.421512079422564, 6.421512079422564, -7.079703398763649, -7.079703398763649, 24.933526118155104, 24.933526118155104, -19.897346474840223, -19.897346474840223, 0.3031750255285892, 0.3031750255285892, 16.48328601627522, 16.48328601627522, 32.567755052577546, 32.567755052577546, 14.53850308697142, 14.53850308697142, 41.04652300293539, 41.04652300293539, -16.211797667628776, -16.211797667628776, -15.792741110834925, -15.792741110834925, 15.484273319968349, 15.484273319968349, -16.631957279267642, -16.631957279267642, 20.209560069505383, 20.209560069505383, 31.522420655227588, 31.522420655227588, 12.413722392712495, 12.413722392712495, -9.028335752186539, -9.028335752186539, 13.385148727362091, 13.385148727362091, -8.54500089397231, -8.54500089397231, 16.76265507482282, 16.76265507482282, 5.929324287080205, 5.929324287080205, 13.408013762423273, 13.408013762423273, 6.768900569935233, 6.768900569935233, -2.8567599548833122, -2.8567599548833122, -1.8977713372409561, -1.8977713372409561, 1.756923467934382, 1.756923467934382, 1.9942811182435518, 1.9942811182435518, 26.127101228757386, 26.127101228757386, 12.096907945813701, 12.096907945813701, -8.899517531505925, -8.899517531505925, 48.532268714375356, 48.532268714375356, -0.4072305823171545, -0.4072305823171545, -8.85657589535849, -8.85657589535849, 9.487865614716906, 9.487865614716906, -3.1440578705052395, -3.1440578705052395, 17.14840399430902, 17.14840399430902, -7.156916574568115, -7.156916574568115, 25.124857417087497, 25.124857417087497, 25.035288790363854, 25.035288790363854, 11.609563781460576, 11.609563781460576, 17.417793034925676, 17.417793034925676, 33.96647212735485, 33.96647212735485, 23.472350295500487, 23.472350295500487, 1.9575592177926657, 1.9575592177926657, 7.939414624209344, 7.939414624209344, -9.431994962278754, -9.431994962278754, 4.168803926588045, 4.168803926588045, 13.215107559266071, 13.215107559266071, 8.938784344462016, 8.938784344462016, -6.950048146016289, -6.950048146016289, 19.79095692982032, 19.79095692982032, 5.946165992690907, 5.946165992690907, 35.09312892876603, 35.09312892876603, -0.3687025695946473, -0.3687025695946473, -15.386785920857177, -15.386785920857177, 29.337599182059982, 29.337599182059982, 20.316844366189997, 20.316844366189997, 0.5452932411751084, 0.5452932411751084, 8.056908646755298, 8.056908646755298, 11.822985945444131, 11.822985945444131, 21.135652685824226, 21.135652685824226, 3.679226384343133, 3.679226384343133, 20.500633857929603, 20.500633857929603, 8.975342421941313, 8.975342421941313, 17.21297304995059, 17.21297304995059, 6.146193139265092, 6.146193139265092, 31.848101983446888, 31.848101983446888, 17.053377693267958, 17.053377693267958, -25.181858692525882, -25.181858692525882, 28.384517931326055, 28.384517931326055, 20.380775230158584, 20.380775230158584, 10.926084919756773, 10.926084919756773, 31.534987952740174, 31.534987952740174, 7.49231998888851, 7.49231998888851, 16.051750353016644, 16.051750353016644, 3.461853204141678, 3.461853204141678, 0.2106894224243625, 0.2106894224243625, 32.892905313358604, 32.892905313358604, 31.0433828400197, 31.0433828400197, 12.207432563981374, 12.207432563981374, 3.79541441757555, 3.79541441757555, -1.4510559250545607, -1.4510559250545607, -5.0017538379173985, -5.0017538379173985, 10.952164996950179, 10.952164996950179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4844898345861441, "mean_inference_ms": 4.218263679740019, "mean_action_processing_ms": 0.1496448534726165, "mean_env_wait_ms": 0.82577650053204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"sample_time_ms": 19342.603, "sample_throughput": 165.438, "load_time_ms": 85.003, "load_throughput": 37645.933, "learn_time_ms": 647.434, "learn_throughput": 4942.587, "update_time_ms": 10.14}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8775.876953125, "policy_entropy": 5134.2041015625, "policy_loss": -4.0292980670928955, "vf_loss": 157610.0859375}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25118.9765625, "policy_entropy": 5147.71435546875, "policy_loss": -0.23173615336418152, "vf_loss": 484589.75}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 57600, "num_steps_trained": 19200, "num_agent_steps_trained": 57600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 768, "training_iteration": 6, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-04-53", "timestamp": 1712765093, "time_this_iter_s": 17.61810278892517, "time_total_s": 116.42394471168518, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256CE41B820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 116.42394471168518, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.070833333333336, "ram_util_percent": 93.875}}
{"episode_reward_max": 41.3555603894301, "episode_reward_min": -60.107436832909784, "episode_reward_mean": -10.241857537439595, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -61.72949322975643, "policy_agent_": -22.931315297832416}, "policy_reward_max": {"policy_adversary_": -3.052547922565895, "policy_agent_": 50.259099650546005}, "policy_reward_mean": {"policy_adversary_": -28.58193317076644, "policy_agent_": 9.170037816663424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.77617841265615, -9.540435916233204, -10.370844858462464, -9.796199726148723, -20.500007717262612, -28.284346444093686, -8.929225026771084, 12.202808829882526, -20.715488626812895, 19.36491048083145, -35.63036566323096, -2.0609475338816603, -16.826577119637502, -5.329769843656135, -15.171625240891398, -5.290495784572843, -33.59371278159544, 41.3555603894301, 8.581125733688213, -22.788358263331755, -10.978882236959421, -20.03565609287198, -6.584240951876062, -12.375963112190602, 1.3638718315743363, -13.944666528862442, -8.022712157271418, -24.275848823178293, -2.8684611806083744, 40.24074204598692, -39.79798034483464, 6.534649249413251, 0.0036293887235888667, -6.57221803769169, 19.537226837109703, -3.3482389051979373, -3.943029440422041, -13.340309983467526, 0.12970680717579564, -4.180994110176327, -6.935826269104079, -56.74945273070966, -29.387301603768062, -26.823099396255046, -6.948537721197619, -16.43670330540009, -5.952018978112047, -8.884079303426308, 9.21573384783151, 20.438988585843738, -31.602059957089633, -52.69864219815422, 11.663703619245421, -16.578837370351298, -34.75671300751349, 9.758346296391363, -18.023412267192587, 2.417980879767928, -40.17695569314436, 5.43987797648694, -10.256201795346277, -8.96342510926139, 21.03417345992589, -39.235450000376844, 7.242927337545369, -49.211786397864245, -12.206392250078267, -1.3725438838386412, -33.62371303037474, 1.8906704738042466, 20.716847429308142, 4.549502334335972, -20.679894367532977, -46.228947799364896, -21.938718509417168, -38.38023722885222, -43.93661083901368, -17.5271777648868, -14.231071472055032, -48.18294502366786, -24.33242971575842, -15.559408435130125, -21.5888641644851, -2.509951440849969, -33.78719079323562, -6.149332635920819, -48.91517851823075, 5.5325360305307445, -6.638866223045184, -15.617216572046345, -22.894963590940034, 27.666317286950214, -15.43287933072051, -10.386572252824841, -14.180065527154458, 14.118193890647934, -23.310843777299194, 17.786283660949213, 10.102029991528195, -36.401582165397194, -7.632420405599603, 24.105519797381394, -19.910522782452674, 22.064663687485453, -47.93683300356362, -38.90002831268041, -60.107436832909784, -16.838364385533783, 1.0881079560576399, -11.337789463734028, -6.654817331398901, -8.56870929316063, -22.275232156025968, 4.982326163267474, -14.977272437365286, -6.668247592357099, 1.7917841300767756, 15.505901593719278, 7.622460998202049, -13.888459774465124, 4.041207483231252, 6.9524241092347285, 25.043549001775915, -25.486368420495836, -1.4665374360764503, -2.754808916042589, 13.587671833216824, 15.280003584271586], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.11512855213743, -6.836989967471122, -36.22664327325457, -19.503414833082413, -21.86580213624324, -13.214521933229879, -28.421505557480224, -42.10876169617357, -47.43367588414731, -41.36177820155548, -22.053634406335767, -42.367927785105856, -25.5358905988116, -14.370315574124394, -44.01756662881104, -52.57404807198405, -11.596208700114289, -59.16263891166191, -25.642733698933966, -15.8192327188932, -13.037210266008191, -23.493146657131227, -15.549029266726155, -21.311758174322684, -46.79294066778341, -42.505098019661496, -32.70381073617913, -12.021053436871185, -22.33124036059527, -58.30492080651394, -14.494777193880246, -24.037398422699617, -22.849709861618056, -13.719220889948613, -51.68439845378783, -24.551600619407807, -31.368701876321325, -40.57062075603459, -33.87906619249364, -27.04685993205767, -28.325683936528613, -17.176590244161105, -24.04096166335272, -4.494499373379393, -39.928376380586634, -22.41881468387365, -33.94377246998532, -29.465134543019133, -25.753616009840993, -52.23496371513729, -33.1845193766526, -18.610904475738522, -50.97479615052344, -48.307187714350974, -14.361982247213307, -34.62185640329504, -33.81477009867589, -35.41565598725491, -8.382418505912542, -17.981641639728714, -29.9939386011588, -14.504532907472495, -39.01778625014685, -21.600101253962976, -41.79337995351516, -16.30315308325666, -43.9018332202452, -34.12504354246309, -28.209589397664505, -52.065656106519334, -38.09910393648323, -24.321527414175645, -43.66800689602877, -17.868032315482164, -23.85551485578651, -43.312503954960825, -7.8023305848259, -14.150766626248188, -21.668136233913597, -23.991309095323523, -17.4589793827394, -37.75830974272717, -43.57061412142579, -27.27630091708539, -38.674043583810246, -12.996158092419627, -3.052547922565895, -32.35122932414237, -25.292309169994393, -14.224676521564897, -25.337323960774235, -45.23379475996533, -9.913380335146556, -24.14369913741762, -6.635273588884861, -38.00332875008945, -17.279843986981046, -39.03988711429219, -37.77317933753139, -24.360028569816947, -32.36686256662717, -58.19322592685154, -26.50626746899031, -38.66248021989205, -13.608357373818285, -9.579286094816512, -16.413517689087453, -22.785863735108418, -18.519973328077064, -38.80020987115809, -37.05950329447563, -37.756932168200315, -11.827710250936402, -30.42308718065845, -12.303270640144683, -23.453092171965533, -28.287091619762702, -35.47743734533493, -36.78313915916941, -19.225144062897336, -61.72949322975643, -29.878791911192366, -60.191252474125406, -11.553039718368314, -16.425472365590956, -36.27020115265733, -19.996122921460934, -42.864338029167705], "policy_policy_agent__reward": [-0.3305249302593618, -0.3305249302593618, -1.351722974381044, -1.351722974381044, 12.927899207396049, 12.927899207396049, 4.853607553466846, 4.853607553466846, 0.6828972094903142, 0.6828972094903142, -7.534912255431904, -7.534912255431904, 9.74614026535457, 9.74614026535457, 27.15578526302805, 27.15578526302805, 13.359093628667212, 13.359093628667212, 30.363344341193468, 30.363344341193468, -6.788365628447593, -6.788365628447593, 20.153490125612105, 20.153490125612105, 4.354656739587049, 4.354656739587049, 4.520272865234131, 4.520272865234131, 14.42297069395982, 14.42297069395982, 23.641776143705606, 23.641776143705606, -10.998752040740571, -10.998752040740571, 50.259099650546005, 50.259099650546005, 17.11192971631109, 17.11192971631109, -3.4845627722192765, -3.4845627722192765, 1.029164014524385, 1.029164014524385, 1.7287452821296232, 1.7287452821296232, 4.482394157425046, 4.482394157425046, 4.467897531066039, 4.467897531066039, 24.07840624967887, 24.07840624967887, 14.28021574539953, 14.28021574539953, 12.340549289453858, 12.340549289453858, -6.127397693153557, -6.127397693153557, 9.731389589993446, 9.731389589993446, 49.27283142625042, 49.27283142625042, -12.651601575477185, -12.651601575477185, 15.286023836056433, 15.286023836056433, 11.426669625170824, 11.426669625170824, 3.5735014261284643, 3.5735014261284643, 35.610812645448775, 35.610812645448775, 10.601680857104935, 10.601680857104935, 13.712836217949636, 13.712836217949636, 13.615155386283533, 13.615155386283533, 17.00438649983471, 17.00438649983471, 11.432932910940671, 11.432932910940671, 10.694928833712268, 10.694928833712268, -19.78643124327428, -19.78643124327428, -2.673169970207671, -2.673169970207671, -11.164300011437822, -11.164300011437822, 16.489919329694505, 16.489919329694505, 2.991055689236779, 2.991055689236779, 13.995876745936638, 13.995876745936638, 10.29052761979641, 10.29052761979641, 17.48467492883625, 17.48467492883625, 36.33697615049051, 36.33697615049051, 0.7912297097814811, 0.7912297097814811, -17.043868861207848, -17.043868861207848, 31.319249884884435, 31.319249884884435, 15.86417517199984, 15.86417517199984, -10.197365380150083, -10.197365380150083, 22.190101349843196, 22.190101349843196, 7.895678915741654, 7.895678915741654, 18.916818433511423, 18.916818433511423, -15.897268593615907, -15.897268593615907, 11.710759808107824, 11.710759808107824, 9.86886840290626, 9.86886840290626, 2.770553899105553, 2.770553899105553, 30.025979855036365, 30.025979855036365, -8.817674373206918, -8.817674373206918, 24.51815364553027, 24.51815364553027, -16.454316657303803, -16.454316657303803, 15.84772048508347, 15.84772048508347, 16.376249829312222, 16.376249829312222, -2.707061816355118, -2.707061816355118, 26.978163290161792, 26.978163290161792, 29.407975682895692, 29.407975682895692, 14.435514874255809, 14.435514874255809, 11.494056264247897, 11.494056264247897, -14.180457741941359, -14.180457741941359, 0.9583981731846666, 0.9583981731846666, 2.466133363054305, 2.466133363054305, -18.067140127093896, -18.067140127093896, -1.6882055693193028, -1.6882055693193028, 3.7185323809292825, 3.7185323809292825, -12.095817964172161, -12.095817964172161, -3.436725166509508, -3.436725166509508, 11.099450653798524, 11.099450653798524, 10.990874978470348, 10.990874978470348, 12.383174738117708, 12.383174738117708, 2.4434263952873208, 2.4434263952873208, 3.423412728249406, 3.423412728249406, -22.931315297832416, -22.931315297832416, 18.941882677336558, 18.941882677336558, 9.326721473474603, 9.326721473474603, -0.6962700252407219, -0.6962700252407219, 1.2211801849170978, 1.2211801849170978, 36.450056023457776, 36.450056023457776, -2.7597494977869776, -2.7597494977869776, 6.878563442296396, 6.878563442296396, -3.7723959691348012, -3.7723959691348012, 26.06076132036869, 26.06076132036869, -3.0154998951590692, -3.0154998951590692, 28.4130853876207, 28.4130853876207, 23.937604664529797, 23.937604664529797, -6.020776797790118, -6.020776797790118, 12.367221080513781, 12.367221080513781, 41.14937286211648, 41.14937286211648, 3.2978723432688173, 3.2978723432688173, 30.363571953688744, 30.363571953688744, -17.164237814872664, -17.164237814872664, -14.660371108931953, -14.660371108931953, -21.846959571911153, -21.846959571911153, 2.973749674787319, 2.973749674787319, 9.804040642067353, 9.804040642067353, 13.731210203712028, 13.731210203712028, 15.202342981538365, 15.202342981538365, 14.594111437519842, 14.594111437519842, -5.223760952544781, -5.223760952544781, 17.70270667196296, 17.70270667196296, -1.3370008986103021, -1.3370008986103021, 8.39242228980422, 8.39242228980422, 15.039437874919741, 15.039437874919741, 25.4916694695271, 25.4916694695271, 22.202800078685726, 22.202800078685726, 2.6683421442161075, 2.6683421442161075, 32.88535035649384, 32.88535035649384, 18.41560801021355, 18.41560801021355, 42.61740073795067, 42.61740073795067, -6.966664351063763, -6.966664351063763, 7.479467464757254, 7.479467464757254, 16.75769611830737, 16.75769611830737, 16.79189737733888, 16.79189737733888, 29.07217080671965, 29.07217080671965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799001360891078, "mean_inference_ms": 4.1632207290045224, "mean_action_processing_ms": 0.1484371339586727, "mean_env_wait_ms": 0.8123912405134349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 22400, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"sample_time_ms": 19098.983, "sample_throughput": 167.548, "load_time_ms": 83.973, "load_throughput": 38107.611, "learn_time_ms": 638.862, "learn_throughput": 5008.908, "update_time_ms": 9.688}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9592.78125, "policy_entropy": 5118.81103515625, "policy_loss": -4.7523685693740845, "vf_loss": 161090.3515625}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24774.3359375, "policy_entropy": 5146.17236328125, "policy_loss": -0.5012187957763672, "vf_loss": 489926.625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 22400, "num_agent_steps_sampled": 67200, "num_steps_trained": 22400, "num_agent_steps_trained": 67200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 896, "training_iteration": 7, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-05-11", "timestamp": 1712765111, "time_this_iter_s": 17.56789803504944, "time_total_s": 133.99184274673462, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256F386E9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 133.99184274673462, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.276, "ram_util_percent": 93.68}}
{"episode_reward_max": 66.0960568980427, "episode_reward_min": -74.86959120991102, "episode_reward_mean": -9.82635377763896, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -76.44104414624304, "policy_agent_": -32.24248230160226}, "policy_reward_max": {"policy_adversary_": -5.845450498237528, "policy_agent_": 71.26855052214289}, "policy_reward_mean": {"policy_adversary_": -28.813883739664327, "policy_agent_": 9.493764981012681}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.48871698058572, -18.015691074311995, -42.44636658408042, 21.70180416284225, 4.761838797185838, -5.136101637732188, 4.8847130824870675, -3.962254306666637, -41.10412802844892, -16.700310979782188, -18.834144228164217, 2.3081679530279553, 6.87706634025471, 26.82410171041797, -39.82739911005178, 5.1514817748611375, -34.31714573292503, -46.86756305047643, -11.336655122669443, -16.449967976610814, -29.714969525835848, 5.396704239931437, -74.86959120991102, -34.542245810390206, -8.375173171837174, -11.40576794588441, -10.311559912980673, -15.664003747963594, -28.45320937746797, -32.587389694417965, -27.914825242275054, -8.453534015398699, 14.263900860386553, -12.410384556355215, -9.377649588391115, -29.252467616521823, -13.640932505457224, 27.572605310530882, -1.3166860444434287, 66.0960568980427, -3.3141789562290827, -12.750046592213714, -0.2148119762331242, 12.424010559380154, -10.456775513458968, -2.4873022308468915, 28.757743075007134, -21.911635850383455, -1.1013410250034532, -2.6434188059729875, -22.052849017282146, 7.14454411534037, -32.34852991983108, 37.40497767332667, -16.465206886485173, -29.701689848963376, -9.066337956713555, -61.0009766652213, -12.818862662214045, 6.301988485118666, -43.60591082895971, -39.753532314492524, 2.8041792604330062, 13.288974966311898, -38.9395847552712, -59.780375941876144, -8.141758718937103, -39.17906729138394, 21.71115522348802, 5.614496843592557, -12.76983041934882, -29.06660688907116, -27.768096894805147, 6.257520645921088, -26.473088334247066, 32.827852208746556, 13.621197829504414, 9.137029970257725, 26.162950913652367, -21.090874225882327, 19.325302064753515, -50.83742816348838, -28.515425750270182, -3.7366016150174697, -4.3237190261357235, 5.628488757064464, -6.257334133844807, -28.73690591860785, -13.693197587111571, 11.757376310296252, -26.473350691009635, -2.2873579299279427, -1.6028109232862187, -9.39936518079867, -15.981678385988742, -20.423373087872243, 27.25416855802839, -22.23863363388104, -26.19204436432057, -0.0032220531520933404, 32.84478820124307, -7.791090812968373, -6.958950231545811, 27.00210945425027, -11.745952741761924, -45.41732398284407, -22.3179172263488, -7.428461854004181, -44.07867775484514, 1.1834758294007355, -13.178080734297994, -38.22176788622381, -6.552384557380643, -5.061456092321412, 5.400620030015018, -31.143133436388855, -26.61233105753754, -3.982853077425816, 14.014322298343519, -16.743513067687342, 20.984060497113315, -8.27401712107132, 14.605524071901183, 6.330641315243206, -6.441660291060812, -9.914526536169507, 12.59643602960084, -15.75158764912909], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.845450498237528, -17.315077504775704, -31.31361098732402, -38.24589529120273, -20.69492934316375, -10.004060782304224, -39.520274926464346, -6.976922371614235, -11.50476070443974, -27.588857750718454, -6.5926230104186185, -37.27796390050372, -31.594068426599854, -39.96675211558908, -15.31962211953188, -27.06152999541985, -16.008069221430492, -42.195185335587496, -18.9046323649418, -14.905587111141815, -38.341767454547615, -26.595723545025667, -10.384626606706522, -6.667730882774272, -44.75234712577233, -54.435195369372856, -24.16953016829443, -15.997484785031686, -31.09296729349789, -37.33694332643624, -14.446695852479357, -6.505481520658458, -38.384655757870384, -43.55304490429644, -10.611987130020594, -36.61587404966487, -23.693476922157576, -37.39248127881255, -44.68996954065984, -76.44104414624304, -25.957885076233424, -24.125724183861085, -38.56985883415687, -39.54230968868319, -13.896120475020407, -25.6389878884986, -54.125137564232915, -41.04913928097812, -24.594349448955594, -16.48839087901555, -17.518985780717323, -32.74535337237973, -23.618038248227816, -62.62714541318843, -7.472341177578524, -15.875161578326638, -15.535291135444497, -17.280265609174126, -11.273627612328863, -25.582381610191668, -22.36863735681842, -31.458538581085495, -18.216294399836556, -37.80382565590896, -9.333660697490789, -13.650328445094809, -39.87788768195907, -27.583304514040673, -39.58483866779749, -31.09126319811354, -42.52438827165995, -25.157402166714014, -19.788689327284395, -24.081303276551218, -22.76153925442265, -45.39201945760177, -44.65673131742236, -29.87393614642235, -37.48298295490135, -5.920615370438496, -46.57806240377852, -29.28784592821261, -52.32556342667715, -22.98984593739201, -18.616523756899884, -52.96219898846671, -21.217588200243394, -17.537869042219935, -24.044262547454984, -53.74212312201093, -20.68535506505339, -39.587838462501054, -54.214500102538864, -35.5518914018454, -21.73286509557198, -16.830321782028044, -46.400364725589135, -26.802752598887825, -29.92125010026595, -10.241183952535753, -56.4099402025181, -16.523637940613266, -10.895060877711503, -41.65916084050827, -20.87237849297966, -24.88804866165726, -22.579036861931243, -50.62556096958089, -12.325091531765036, -23.583416172975348, -22.97134198497003, -33.52632355680544, -48.33756503352805, -44.377470865603556, -36.20516354371289, -27.44346473085633, -40.15513282078014, -18.17137444152197, -52.44309730450776, -22.669050595673593, -32.2523081304469, -11.773934035308947, -28.60995616323998, -45.883233976576165, -29.843514603766394, -16.93699166861465, -38.72942646141445, -33.14664654680312], "policy_policy_agent__reward": [-21.821633241174098, -21.821633241174098, -0.3503067847681439, -0.3503067847681439, -5.566377798378203, -5.566377798378203, 29.973849727022486, 29.973849727022486, 12.728384070174796, 12.728384070174796, 2.433979572286018, 2.433979572286018, 22.202494004475707, 22.202494004475707, 1.5073340324737994, 1.5073340324737994, -14.799683662004588, -14.799683662004588, 5.444273385468135, 5.444273385468135, -6.120760608872801, -6.120760608872801, 19.793065926765838, 19.793065926765838, 19.235567383427284, 19.235567383427284, 33.39542691300352, 33.39542691300352, -12.253888495259957, -12.253888495259957, 16.106505885140493, 16.106505885140493, -9.15453825574727, -9.15453825574727, -2.336188857444464, -2.336188857444464, 3.783988621136178, 3.783988621136178, -0.7721904327345035, -0.7721904327345035, 4.313398964355883, 4.313398964355883, 15.996213892478552, 15.996213892478552, -32.24248230160226, -32.24248230160226, -13.937257463807969, -13.937257463807969, 18.18858697696758, 18.18858697696758, 21.514713711744214, 21.514713711744214, 6.928985127656876, 6.928985127656876, 0.16674051853404248, 0.16674051853404248, 1.3198789580149597, 1.3198789580149597, 2.374776816009148, 2.374776816009148, -6.7340646948978495, -6.7340646948978495, -0.9740262473701186, -0.9740262473701186, 26.324278309128466, 26.324278309128466, 15.571330173970612, 15.571330173970612, 0.6171687708147406, 0.6171687708147406, 3.6817032165715218, 3.6817032165715218, 5.026272208350175, 5.026272208350175, 32.48254329467172, 32.48254329467172, 21.686641748108205, 21.686641748108205, 71.26855052214289, 71.26855052214289, 11.321853060002168, 11.321853060002168, 5.687838795823685, 5.687838795823685, 19.17752342896187, 19.17752342896187, 25.98316012403167, 25.98316012403167, 1.7196724807807184, 1.7196724807807184, 11.575842828825857, 11.575842828825857, 41.44144031962002, 41.44144031962002, 9.568751715297342, 9.568751715297342, 11.746504211976074, 11.746504211976074, 6.92248603652128, 6.92248603652128, -2.2669316182824115, -2.2669316182824115, 19.94494874386005, 19.94494874386005, -4.36524583580163, -4.36524583580163, 50.01606154325754, 50.01606154325754, -4.4964328544533245, -4.4964328544533245, -6.913264135318375, -6.913264135318375, 3.2344765893654728, 3.2344765893654728, -21.86035552802359, -21.86035552802359, -0.7726175249425891, -0.7726175249425891, 15.942185047655164, 15.942185047655164, -10.618636736070643, -10.618636736070643, -4.147496866703518, -4.147496866703518, 10.510236830134783, 10.510236830134783, 25.546400311110435, 25.546400311110435, -14.802962028890196, -14.802962028890196, -23.06502374839066, -23.06502374839066, 15.868064481510984, 15.868064481510984, -5.797881388671622, -5.797881388671622, 30.647996945642756, 30.647996945642756, 18.35288002085304, 18.35288002085304, 14.877278926155562, 14.877278926155562, -1.9546023611785657, -1.9546023611785657, -3.989703783760369, -3.989703783760369, 15.169411961236154, 15.169411961236154, -1.8557745399122, -1.8557745399122, 39.10993583317417, 39.10993583317417, 29.138964573463387, 29.138964573463387, 19.50548305834003, 19.50548305834003, 31.822966934276856, 31.822966934276856, -7.585129427721915, -7.585129427721915, 32.951682234266016, 32.951682234266016, -10.77479111763789, -10.77479111763789, 11.90506883820348, 11.90506883820348, 9.626622161187266, 9.626622161187266, 7.146402365382077, 7.146402365382077, 29.295343872765592, 29.295343872765592, 7.480127033199295, 7.480127033199295, -5.599518438193953, -5.599518438193953, 5.175532480171713, 5.175532480171713, 32.749749716153595, 32.749749716153595, -2.893997812978124, -2.893997812978124, 18.65024026628656, 18.65024026628656, 26.305844589626318, 26.305844589626318, 13.076263110523364, 13.076263110523364, 2.8755933547916204, 2.8755933547916204, -1.7965256529220968, -1.7965256529220968, 36.82726664180876, 36.82726664180876, 2.282059482503393, 2.282059482503393, 1.864602867972692, 1.864602867972692, 5.118980949691827, 5.118980949691827, 44.62736420188059, 44.62736420188059, 4.366273563822449, 4.366273563822449, 1.9680553230828435, 1.9680553230828435, 34.33063514737927, 34.33063514737927, 4.563212875608868, 4.563212875608868, -10.264637660593403, -10.264637660593403, 0.13055981779122416, 0.13055981779122416, 21.598549557788356, 21.598549557788356, -15.876793111540067, -15.876793111540067, 12.383446001188041, 12.383446001188041, 4.8966306253360194, 4.8966306253360194, -2.347722164709179, -2.347722164709179, 20.892590238073698, 20.892590238073698, 19.658007386641074, 19.658007386641074, 20.80289178686395, 20.80289178686395, -1.8498343527662655, -1.8498343527662655, 6.7714008816213, 6.7714008816213, 7.094260682048075, 7.094260682048075, 33.228709801425644, 33.228709801425644, 2.9627687639931257, 2.9627687639931257, 26.618184313780098, 26.618184313780098, 1.7499584571188134, 1.7499584571188134, 21.607740117570575, 21.607740117570575, 26.10693764590968, 26.10693764590968, 11.700927156352789, 11.700927156352789, 3.5112325662225703, 3.5112325662225703, 25.66293124550765, 25.66293124550765, 8.697529448837017, 8.697529448837017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4807961582648587, "mean_inference_ms": 4.183109344614144, "mean_action_processing_ms": 0.1487938772257937, "mean_env_wait_ms": 0.8170642050387014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 25600, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"sample_time_ms": 19185.119, "sample_throughput": 166.796, "load_time_ms": 84.95, "load_throughput": 37669.125, "learn_time_ms": 645.144, "learn_throughput": 4960.132, "update_time_ms": 9.728}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10943.3515625, "policy_entropy": 5064.3525390625, "policy_loss": -9.43246603012085, "vf_loss": 182752.6015625}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24913.251953125, "policy_entropy": 5143.27734375, "policy_loss": -1.3821163177490234, "vf_loss": 509102.125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 25600, "num_agent_steps_sampled": 76800, "num_steps_trained": 25600, "num_agent_steps_trained": 76800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1024, "training_iteration": 8, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-05-31", "timestamp": 1712765131, "time_this_iter_s": 19.862139225006104, "time_total_s": 153.85398197174072, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256F5CE6280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 153.85398197174072, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.542857142857144, "ram_util_percent": 93.73928571428573}}
{"episode_reward_max": 41.42718557476825, "episode_reward_min": -68.29949719055891, "episode_reward_mean": -7.797142134786849, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -61.068605278371166, "policy_agent_": -20.320917913480823}, "policy_reward_max": {"policy_adversary_": -6.544921503181713, "policy_agent_": 45.46663495887202}, "policy_reward_mean": {"policy_adversary_": -25.76990952107763, "policy_agent_": 8.986383693145392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.050344550787358, 13.622581213715142, -21.71493641300026, -14.209816254094267, -4.265872585538055, -8.208413665796344, 11.88366281765787, 6.295000168274044, 12.410990709040945, 7.164258974154558, -68.29949719055891, 11.697765334835266, -14.460292617535146, 28.32252379858231, 7.242305762190526, 3.30543186775697, 2.9307178731939603, -14.816731075108722, 24.4658575888475, -38.26609754003631, -16.741813531383045, -36.65915757486926, 17.005815007353753, 8.768208572984667, -2.5110004751312704, -14.723770094306769, -18.19596145027273, -39.87162167487295, -10.838958476651621, -15.38850750111998, -6.002749138268739, -34.1968231894082, 20.775819987013335, -2.3999212398376084, -20.575557740497846, 4.403558135713091, -10.92472753663427, 10.211893429511797, -1.228195084047131, -18.137291637600907, 1.3197613518370068, -23.511446929303148, -24.715665463432412, -7.132900524102849, -6.131388298292208, 16.253653830011558, 13.745778663458173, -26.629161003068084, 1.0533280385685888, -7.1780439875665, 16.56522387010705, 0.8055603569997742, -6.0355145342710745, -54.337690676492485, -0.8384472594142168, 2.4674038492482406, 22.896284376138556, -10.159163516828077, -1.5712445986862982, 8.561374873233644, 20.095065278319176, -29.62747319296046, -32.53169276702624, -29.13924870030857, -47.222946899468134, -31.969615675833975, 19.562321115268645, -1.7902727617428829, 19.818444161741663, -12.698050844747748, -1.8628669668886737, -27.038508390663004, -30.032353499191323, -41.93567721725054, 6.505705631273826, -16.605069863016165, -39.31030455677212, 5.537062734595463, 7.219669161579723, 13.155475241226341, -16.935201988859305, 21.354889506538733, -41.61227903822918, 4.07713584045781, -11.49899638921643, -19.157488405797793, -36.09400051812305, 22.092051917616878, -5.207642067395311, -11.911493496742109, 21.207982144912144, 16.464444010944494, -41.72137223810846, -25.809935178591978, -11.637424543053942, -17.6631503504241, -53.11012766840291, 15.957052153096804, -9.760598047399604, -27.52545655436741, 8.957875287250031, 10.853881242336088, 0.009724114347269053, -35.287582226948196, -20.60223081164266, -12.877376453580869, -16.48311271188433, 7.0768161780902545, -7.38201494149758, -3.8044397293137453, 10.784223626334523, -0.12828997798610797, -9.753858489766653, -51.49994810163371, -6.604050687473081, -24.8728330259978, -14.103414011145443, -4.963010677151347, 1.1443580323672298, -7.941536113457575, 0.8842322650668523, -10.64196583728997, 19.811729304527255, -23.29961209012442, 41.42718557476825, -24.611983533574787, -24.079604429324142, -16.032130628190288], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-43.24960035153575, -44.77311035780515, -7.720408447383742, -15.721412209951794, -51.52592090105879, -16.602441127145433, -40.07412156523477, -29.59560133433453, -26.374781235395304, -25.80261807775741, -27.657661363597253, -27.234283085525263, -8.272887007102096, -58.49255577503308, -19.493438294572833, -38.621731469731586, -15.071359287954976, -12.025461140277372, -45.03195439937952, -6.804653470944284, -39.00125883363146, -17.040888442398316, -32.496492845457084, -35.917581986654106, -27.502264963330607, -21.540105945328627, -6.544921503181713, -8.681712570850353, -17.441677022310085, -8.316261550082364, -26.02581825224837, -13.875559435333049, -38.52127802059425, -19.952533494437905, -12.801305093680387, -12.979664785046305, -18.051921663132102, -31.147916542801834, -15.94141901902678, -23.363866714264635, -29.49471300692502, -10.3936341780912, -33.03415400617527, -38.94137165400238, -22.33773643640391, -32.32234816977916, -24.48698726294714, -11.970162979890828, -24.325683720232945, -17.175130048621234, -34.59294471662864, -19.212695548070162, -23.40689910492967, -21.92120047217784, -20.382817248505983, -25.900298970872136, -61.068605278371166, -37.599324094850125, -31.130112177792213, -38.79117629401617, -38.96348484471318, -20.76201167972106, -23.66628599510696, -27.0945851472828, -32.21296769149907, -19.699135525407268, -50.58466682811874, -22.374881227032393, -28.23102770845766, -21.40260396445408, -38.197876708174206, -16.00036894736996, -7.156770736033555, -18.29682356520408, -20.844320672614064, -37.180170258844214, -23.552182199209195, -22.396575540806168, -27.573158259015848, -34.68123991435847, -22.956403135638332, -39.05962552930916, -12.986957501169067, -35.84258839469913, -35.56534739691677, -27.57088076007265, -20.68743166495995, -34.27220470094586, -15.238369661685583, -12.347274224446418, -30.041182019140038, -31.74366762702265, -18.28166474445895, -16.81705400815624, -18.50121209299945, -15.417517186697829, -12.773804851024014, -34.209949965691365, -10.394653037203874, -12.566071764701624, -34.77490863907596, -26.764935152068293, -23.7812082690175, -36.00488494709357, -30.690887254757907, -29.85553642327364, -28.041314862924583, -41.12608524652283, -20.378208568420927, -14.072566653370327, -30.1729988224446, -39.51282116658718, -44.97818686923925, -13.113901201201289, -12.028972244178592, -23.10378609658452, -13.07639795936112, -13.533173715274383, -29.527635329771122, -32.15235216031149, -18.35699241017668, -20.90452567337421, -37.789887564012815, -15.184158009343363, -49.506084342975804, -20.0277006655297, -11.48272445921208, -54.682141356676944], "policy_policy_agent__reward": [32.14997245116155, 32.14997245116155, 29.19784578576015, 29.19784578576015, -6.997263982808256, -6.997263982808256, 0.7557979779287589, 0.7557979779287589, 23.630024157760367, 23.630024157760367, 4.197013730674547, 4.197013730674547, 25.978892191446313, 25.978892191446313, 17.945300751304288, 17.945300751304288, 19.39288597221812, 19.39288597221812, 16.48343852595599, 16.48343852595599, -20.320917913480823, -20.320917913480823, 19.466024210180272, 19.466024210180272, -3.093702805216523, -3.093702805216523, 43.40753978680769, 43.40753978680769, 13.36787202838168, 13.36787202838168, 20.963581668744272, 20.963581668744272, 9.001038580574468, 9.001038580574468, -1.3956349674156763, -1.3956349674156763, 34.7489059941135, 34.7489059941135, -15.73072203454602, -15.73072203454602, 11.129722651124208, 11.129722651124208, -9.80913456623546, -9.80913456623546, 24.751153926405422, 24.751153926405422, 22.342895279819388, 22.342895279819388, 12.495632244099667, 12.495632244099667, 3.4081679255109316, 3.4081679255109316, -5.825519973545507, -5.825519973545507, -15.5949545520113, -15.5949545520113, 3.3013592728292305, 3.3013592728292305, -3.5361229755188077, -3.5361229755188077, 10.011534556989815, 10.011534556989815, -10.16063187703758, -10.16063187703758, 29.64854900380379, 29.64854900380379, 8.776306127300149, 8.776306127300149, -3.887126323408731, -3.887126323408731, 8.691611460379699, 8.691611460379699, 3.5635970632489173, 3.5635970632489173, 20.679904986156817, 20.679904986156817, 7.3566119674898225, 7.3566119674898225, 2.6132875383318632, 2.6132875383318632, 15.407237179381015, 15.407237179381015, -6.5589063756059875, -6.5589063756059875, 4.159244271371434, 4.159244271371434, 15.904235564949765, 15.904235564949765, 8.103174069055852, 8.103174069055852, 24.28800099989536, 24.28800099989536, 19.11638296320266, 19.11638296320266, -7.329499011588632, -7.329499011588632, 12.689505879400768, 12.689505879400768, 4.998543030527365, 4.998543030527365, 25.579084293367853, 25.579084293367853, 10.009127952534968, 10.009127952534968, 8.685692285329296, 8.685692285329296, -16.20824510215733, -16.20824510215733, 9.772184994545883, 9.772184994545883, 14.183851410060191, 14.183851410060191, 41.98244482725488, 41.98244482725488, 13.720080289011024, 13.720080289011024, 14.779433789552963, 14.779433789552963, 23.6762755836249, 23.6762755836249, 29.529275061516174, 29.529275061516174, -4.432730756619694, -4.432730756619694, -4.4327033859596465, -4.4327033859596465, -1.022331776512884, -1.022331776512884, -7.504989603984528, -7.504989603984528, -6.135240075213351, -6.135240075213351, 35.07349397169368, 35.07349397169368, 10.292304232644758, 10.292304232644758, 24.024735935099667, 24.024735935099667, 4.3522765598531645, 4.3522765598531645, 18.167504870642777, 18.167504870642777, -5.51906972164653, -5.51906972164653, -11.437791381578883, -11.437791381578883, -11.81942682602324, -11.81942682602324, 13.675013151943949, 13.675013151943949, 10.28755019791403, 10.28755019791403, -7.879061178781462, -7.879061178781462, 13.966819137700815, 13.966819137700815, 17.396413710297793, 17.396413710297793, 23.918357577792406, 23.918357577792406, 3.0106005733895183, 3.0106005733895183, 30.207257517923946, 30.207257517923946, -14.312660768530058, -14.312660768530058, 19.959862117578474, 19.959862117578474, 12.03317550385017, 12.03317550385017, 4.206696177137428, 4.206696177137428, -7.70328442658155, -7.70328442658155, 28.182128309281367, 28.182128309281367, 5.015363797145136, 5.015363797145136, 0.21789036385215602, 0.21789036385215602, 25.62458208202609, 25.62458208202609, 24.104055818983568, 24.104055818983568, -11.71985374682475, -11.71985374682475, -4.49644058521787, -4.49644058521787, 3.4318937749727585, 3.4318937749727585, -1.1228165818631382, -1.1228165818631382, -20.168161408689443, -20.168161408689443, 25.083501059394084, 25.083501059394084, 0.31702749490213344, 0.31702749490213344, -7.479692394832894, -7.479692394832894, 21.86639196316299, 21.86639196316299, 18.809408197202195, 18.809408197202195, 11.895466191682385, 11.895466191682385, 0.3586513600726915, 0.3586513600726915, 5.04432822155762, 5.04432822155762, 8.489079984846386, 8.489079984846386, 5.779101075520128, 5.779101075520128, 24.10145071230654, 24.10145071230654, 6.498096813461673, 6.498096813461673, 5.134063462028292, 5.134063462028292, 20.47861122438956, 20.47861122438956, 19.69226559430054, 19.69226559430054, 17.612164189736298, 17.612164189736298, -19.19302345021623, -19.19302345021623, 2.7124607783527535, 2.7124607783527535, -0.884523464706636, -0.884523464706636, -0.5135080258921614, -0.5135080258921614, 4.285081519061519, 4.285081519061519, 15.335996681069174, 15.335996681069174, 12.105408023426955, 12.105408023426955, 9.620612337621768, 9.620612337621768, 5.131279918042118, 5.131279918042118, 28.800808434270042, 28.800808434270042, -4.057727040390526, -4.057727040390526, 45.46663495887202, 45.46663495887202, -2.2921414340225406, -2.2921414340225406, -6.2984399850560235, -6.2984399850560235, 19.325005364243317, 19.325005364243317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4767959744792601, "mean_inference_ms": 4.174496704437457, "mean_action_processing_ms": 0.14752186212658547, "mean_env_wait_ms": 0.8160514238166221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"sample_time_ms": 19146.005, "sample_throughput": 167.137, "load_time_ms": 84.824, "load_throughput": 37725.217, "learn_time_ms": 640.389, "learn_throughput": 4996.96, "update_time_ms": 9.977}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9921.720703125, "policy_entropy": 4985.7900390625, "policy_loss": -9.88371467590332, "vf_loss": 140709.33203125}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22773.169921875, "policy_entropy": 5139.83251953125, "policy_loss": -1.7809994220733643, "vf_loss": 387764.375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 86400, "num_steps_trained": 28800, "num_agent_steps_trained": 86400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1152, "training_iteration": 9, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-05-50", "timestamp": 1712765150, "time_this_iter_s": 18.697331428527832, "time_total_s": 172.55131340026855, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000025685511940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 172.55131340026855, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.803846153846152, "ram_util_percent": 93.13076923076922}}
{"episode_reward_max": 51.06452065316919, "episode_reward_min": -82.94125373249194, "episode_reward_mean": -10.250264245759801, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -73.54527750074048, "policy_agent_": -33.094202177743774}, "policy_reward_max": {"policy_adversary_": -5.651707499328812, "policy_agent_": 55.28601323053433}, "policy_reward_mean": {"policy_adversary_": -28.022749430491626, "policy_agent_": 8.88624259236591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.371934719731307, -18.92388768107866, 14.189679309591337, -6.634395358885158, 9.53013564641449, -27.891383234857372, -12.44996985970526, -32.91053463011496, 2.795520906285665, 5.5724248720457235, -34.96307489162069, -34.13120226571782, -36.578858360548686, -32.04825804837726, 27.049974275102574, -1.1793014223110772, -23.169728560411126, -6.23858966861107, -18.61461674318677, 2.948953809902872, -14.028520617892955, -8.703414832336893, -3.492300631209626, -2.21963920578854, 21.966204649245753, -10.691625409629102, -40.16037433589789, -9.148567030764344, -30.95855920048265, -11.044941525398345, -3.925040064312047, 17.685386596278388, -26.236405090312275, -35.83552375125461, -65.38992389244882, -15.711052786234934, 17.28935791301005, -12.895936658002057, 5.899130022981961, 5.3291336019679365, 18.818747326289127, 4.1705579531354084, 14.175796173899585, -20.942539577546604, -7.754759581434566, -6.609646056956729, 4.061047304872359, -5.589045458979744, -22.553891148932735, -82.94125373249194, -33.909497542564154, -5.5018718480488875, 18.417869737694815, -4.38773842318953, -19.97199612561895, -14.044825846722913, 0.14624348836477763, 12.984213636595243, -9.16317646249463, 5.151497743820077, -25.141033661772134, -27.036917368517372, 12.655912988505113, 6.702129444774489, -25.741645968015554, 4.120807337434802, -10.035879521780563, -13.71070960907397, 13.912426302419448, 3.6662929836475096, -3.293210315644907, -12.675824395268963, -4.345350900703682, -10.82892430554436, -32.16035955339358, -28.378168655934836, -3.963166934772743, 0.5622323816849953, 10.275327350834942, -26.158809111039236, 1.9616801148825216, -6.88751912503211, -0.41187818494191575, -23.465472645652365, 20.338164116386285, 5.900961483351918, -47.68657597393846, -51.516008520659405, 4.601652120060386, -27.544903714755826, 3.6102827272655844, -3.7948700282776384, 20.956751159371972, 51.06452065316919, 14.556303358148702, -14.051190196582054, -40.93416589323099, -14.302783824583113, -18.95222182111451, -12.683463136389282, -34.343549568337295, -4.553889062272752, -19.561463283615673, -29.766138836393385, 3.807201426886051, 22.712012979277848, 11.42863402035734, -19.51726150332038, -24.164739995766013, 7.668346008731444, -23.17396418474598, -10.584592043786575, -18.266030741020607, -28.01552189980187, -27.040181112400642, -12.615868783108914, -19.88765815087736, -15.6779702461877, 20.818132541273204, -35.65842838948222, 7.999503191065644, -22.817996801958323, -31.39176215919112, -11.088985849783658, -8.273667463497581, -34.76633190070818, -12.804454990025988, -12.945660499276523], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-72.23098841605737, -28.1506525537973, -35.91170722334015, -41.42684255327566, -25.505928459865576, -22.705845250247, -37.5319283809752, -17.733859265375155, -33.375022915594165, -27.46046833172501, -21.82011538809911, -30.166033349102353, -19.663181564627536, -31.442370608404058, -44.63640139683131, -42.66243225763684, -16.882819638158633, -25.47217182778673, -25.131016544461353, -43.90837070118166, -29.664440618965525, -12.171625019704866, -31.658166406612228, -32.63341537459948, -40.226804107113196, -17.119571512827775, -17.26912616825728, -25.237993179033115, -25.734500433164374, -56.10021490766316, -14.878350111487672, -29.60523699315106, -29.5979408899434, -13.022380271889345, -11.892595136318008, -35.20614928040642, -28.887336076899224, -12.896696993645643, -27.689417887444026, -18.546941284472155, -34.72370276415723, -17.562743234450327, -34.902447200733356, -9.836446552217929, -20.971925485847407, -18.917606048694882, -44.71665563996404, -14.671441189434749, -31.70078718573271, -16.752849377004413, -36.77164864750997, -55.97637417019693, -54.97801361810669, -36.37431592379647, -38.729786024927364, -12.436423333529264, -19.96219890716874, -28.710702817852695, -24.24899026909786, -36.822918023886956, -38.58170225754417, -24.688996174858485, -32.38448456628216, -36.31650143326377, -14.451724768894653, -24.97516843602182, -25.615102674592684, -25.802192867786044, -44.491575001185424, -24.02327635288877, -28.059357158066817, -21.00491554417321, -58.439363716264566, -36.08285733321199, -15.358689867212398, -16.813553547286038, -11.528709401787928, -16.745844245996217, -31.66274875087091, -6.2185854511301395, -26.549435795955947, -32.34665679820351, -12.479274204808235, -17.111026041192442, -32.9271021320184, -30.444105904024106, -31.922531627570066, -32.142195057102725, -17.05329343838319, -40.44735840695858, -20.420589002909338, -31.285557953416603, -50.121870089451875, -59.50750580789947, -27.348346760538657, -27.968543087134705, -5.651707499328812, -17.718067516074754, -23.34163051961856, -19.617397215863946, -13.833398631297294, -42.97226600980252, -30.293010455716022, -11.949244907230131, -73.54527750074048, -38.50940035989943, -39.71536451836459, -26.780954567582008, -42.12662480734054, -43.34101635871906, -8.368073014970124, -13.191837402626607, -10.849647346249013, -7.428463727258581, -18.88594938328637, -26.41721773237133, -32.27861073648285, -20.34372834168976, -37.09069949783425, -7.296389450586754, -31.931771783841857, -17.74397182013452, -29.40362400479864, -33.23273098522773, -38.023972463464716, -32.449708848290335, -16.342069364606676, -9.292322980293282], "policy_policy_agent__reward": [27.42952684816302, 27.42952684816302, 4.613382436359318, 4.613382436359318, 25.050693266465746, 25.050693266465746, 17.39622359719525, 17.39622359719525, 17.518032053140033, 17.518032053140033, -2.5927689923051904, -2.5927689923051904, 12.540979260634977, 12.540979260634977, -7.588337682369899, -7.588337682369899, 18.08527191093991, 18.08527191093991, 16.516446601885367, 16.516446601885367, -6.57147975176079, -6.57147975176079, -1.9825844583077321, -1.9825844583077321, -8.457838397960579, -8.457838397960579, -0.3029437199866001, -0.3029437199866001, 35.84318783596693, 35.84318783596693, 20.741565417662876, 20.741565417662876, -3.1434544611262414, -3.1434544611262414, 9.616791079587836, 9.616791079587836, 3.258199900637294, 3.258199900637294, 23.428662255542267, 23.428662255542267, 7.817960000536287, 7.817960000536287, 1.7341050936839892, 1.7341050936839892, 14.082932887701293, 14.082932887701293, 15.20688808440547, 15.20688808440547, 31.096504378179468, 31.096504378179468, 3.213973051599339, 3.213973051599339, -11.44562408382031, -11.44562408382031, 8.044713074134384, 8.044713074134384, -2.6120293836591397, -2.6120293836591397, 22.52763669113241, 22.52763669113241, 5.476655023587812, 5.476655023587812, 23.645311794714726, 23.645311794714726, 1.680767899815561, 1.680767899815561, -11.406571739682624, -11.406571739682624, -26.74866437806541, -26.74866437806541, 9.747548247085746, 9.747548247085746, 23.088346994954637, 23.088346994954637, 0.0003801678217918436, 0.0003801678217918436, 16.79427395521299, 16.79427395521299, 11.938037443220047, 11.938037443220047, 26.77122504522318, 26.77122504522318, 10.866650593792869, 10.866650593792869, 24.53912168731646, 24.53912168731646, -5.553046512664327, -5.553046512664327, 6.608582952206418, 6.608582952206418, 6.153979995869079, 6.153979995869079, 24.3888514724182, 24.3888514724182, 4.541197865227504, 4.541197865227504, 4.573448018399989, 4.573448018399989, -33.094202177743774, -33.094202177743774, 1.4310755524729033, 1.4310755524729033, 25.23725116107402, 25.23725116107402, 36.69794167790075, 36.69794167790075, 15.993288750303476, 15.993288750303476, 9.378894949654212, 9.378894949654212, -0.804201256596827, -0.804201256596827, 10.054221197766761, 10.054221197766761, 20.847458227223967, 20.847458227223967, 7.542906903301615, 7.542906903301615, 20.987207883853515, 20.987207883853515, 6.720334297886013, 6.720334297886013, -1.1739605968294424, -1.1739605968294424, 22.520198777393635, 22.520198777393635, 21.50931543901913, 21.50931543901913, -5.644960599560457, -5.644960599560457, 14.547987886728313, 14.547987886728313, 7.7896115764060605, 7.7896115764060605, 6.04574162935604, 6.04574162935604, 29.202000651802432, 29.202000651802432, 13.844784668268142, 13.844784668268142, 12.383073421210959, 12.383073421210959, 4.164545574452124, 4.164545574452124, 27.04700640778045, 27.04700640778045, 12.626966513833818, 12.626966513833818, -8.4008348430906, -8.4008348430906, -5.782307554324382, -5.782307554324382, 3.7827712335075896, 3.7827712335075896, 8.654038313840605, 8.654038313840605, 20.96903805085293, 20.96903805085293, -9.970111829954545, -9.970111829954545, 14.255557955419235, 14.255557955419235, 12.729568836585704, 12.729568836585704, 6.033698009933161, 6.033698009933161, -3.1772233022299643, -3.1772233022299643, 26.63263312420234, 26.63263312420234, 18.172533693688013, 18.172533693688013, -7.882022173184188, -7.882022173184188, -9.686906731778357, -9.686906731778357, 10.827472779221793, 10.827472779221793, 6.45122734610138, 6.45122734610138, 12.01543586508746, 12.01543586508746, 13.745343962569484, 13.745343962569484, 35.539310624411925, 35.539310624411925, 55.28601323053433, 55.28601323053433, 20.952325059343675, 20.952325059343675, 6.958676445276325, 6.958676445276325, -17.64122919695108, -17.64122919695108, 1.7076418457458216, 1.7076418457458216, 2.194704349252026, 2.194704349252026, 3.466967039737332, 3.466967039737332, -10.255075468519998, -10.255075468519998, 19.209188473764883, 19.209188473764883, 5.365773586050171, 5.365773586050171, -8.90844696458163, -8.90844696458163, 38.67623946381327, 38.67623946381327, 30.610706669588634, 30.610706669588634, 25.571999269360962, 25.571999269360962, 3.631846532130811, 3.631846532130811, 8.980942405787264, 8.980942405787264, 25.504681183725253, 25.504681183725253, -7.402945584887932, -7.402945584887932, 1.303622679420016, 1.303622679420016, -3.708191697385802, -3.708191697385802, -10.293529086271644, -10.293529086271644, -4.0771158645571335, -4.0771158645571335, 6.900674474631213, 6.900674474631213, 6.19547629280274, 6.19547629280274, 2.3328790477510353, 2.3328790477510353, 28.95441601955373, 28.95441601955373, -14.181019469447737, -14.181019469447737, 19.965637487453748, 19.965637487453748, -2.5370124909118985, -2.5370124909118985, -0.994069077196242, -0.994069077196242, 11.071872567722036, 11.071872567722036, 14.87515249998356, 14.87515249998356, -1.1583115262089252, -1.1583115262089252, 1.7688071872903421, 1.7688071872903421, -1.8266687594916249, -1.8266687594916249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4730436199251767, "mean_inference_ms": 4.1515497948086955, "mean_action_processing_ms": 0.14707208525363005, "mean_env_wait_ms": 0.8122602338615956, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 19044.51, "sample_throughput": 168.027, "load_time_ms": 84.416, "load_throughput": 37907.395, "learn_time_ms": 637.344, "learn_throughput": 5020.833, "update_time_ms": 10.073}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10464.271484375, "policy_entropy": 4858.8837890625, "policy_loss": -14.541847229003906, "vf_loss": 138575.5625}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24511.5234375, "policy_entropy": 5132.71142578125, "policy_loss": -2.328397512435913, "vf_loss": 465496.15625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 96000, "num_steps_trained": 32000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1280, "training_iteration": 10, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-06-08", "timestamp": 1712765168, "time_this_iter_s": 18.09461283683777, "time_total_s": 190.64592623710632, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000025685393CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 190.64592623710632, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.44, "ram_util_percent": 93.32400000000001}}
{"episode_reward_max": 37.64115296611968, "episode_reward_min": -71.80508914951447, "episode_reward_mean": -8.134645167045287, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -74.54357630499766, "policy_agent_": -24.69728861716062}, "policy_reward_max": {"policy_adversary_": -5.210100982425731, "policy_agent_": 56.09236463555867}, "policy_reward_mean": {"policy_adversary_": -26.039294114785523, "policy_agent_": 8.952324473870117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.804180260795054, 9.225382422067327, -27.87718576927657, 15.97460554399007, 1.943743792242478, 18.913512947062213, -7.111429347422773, 5.827011571049895, -29.656306618437146, -21.393688747383457, -26.562789338581716, -32.4170864098237, 6.695604457772944, 9.777039124317907, 3.5155212930013557, -40.52874083222981, -2.60612943389241, -17.3129543544992, -24.703254940305065, 3.5412214392915295, 9.273421643381987, -9.73259058223137, 9.555542231996556, -0.135543584785068, 11.735815101745535, -10.890176544025103, -3.702299095647768, -7.746854865474593, 5.565735470737245, -26.145929690149927, 11.348610334876048, 11.55236056629416, 7.173506536543753, -11.004641316218736, 23.789935907833133, -19.571567241286225, -17.783907232611767, -12.014497084596163, -44.35285804929693, 14.344542338744164, -1.433521624161684, -6.842450421227792, -18.753870560321804, -26.86953141561063, -71.80508914951447, -16.336632237080302, -8.973446836990849, -7.091996408909821, -30.24813027297063, -12.35753917842023, -3.8504315490909695, -13.188176945837975, -31.640403628583933, -33.70927469763685, -13.463515338318793, -6.8840143802276135, -5.622341282355293, 1.6345572613320871, -16.239750537764284, 13.004923011875105, 11.373266437163714, -5.521534714780135, -30.663443567750114, -9.461812855332123, -28.67158941516814, -7.896595167856945, 15.00676295607654, 18.396042110619938, 5.869871789566428, 13.00841600503573, 0.8786303468808241, 5.337138160598565, -30.080273527020925, -18.375759181838518, -19.689740429343836, -0.45993503716092077, -4.933210369527245, 5.74710646020371, -12.359615773447677, -8.459197912282438, -10.247187845607792, -11.103965182077351, -22.13637393768839, 24.16475833285193, 2.0459307456816624, -9.047274086086436, 12.334359215753581, -10.518661176213184, 9.529022857876196, -2.9829833026463968, -11.034466735553968, -23.582323507697115, -18.29877761920546, -24.857198649384014, 14.143264965701883, -7.789250338892903, -47.006933684017056, -29.952291252552623, -18.924173939694796, -8.049499713947457, -12.50250530737206, -16.22501373104381, -11.824952230720735, -14.075564132948628, -16.837593884620865, 1.851773835609554, -21.654442902041275, -16.208313503455194, 4.780677486396214, -16.306449853285976, -6.627254544300704, 7.122037274081195, 7.723353980489067, -17.047516557066665, -6.922170746207932, -6.749196091775273, -10.706160889576251, 2.9114260819923587, 1.6681031046906443, 2.3131904864431125, -16.600317810705864, -37.1018209449831, -14.509079052848655, 37.64115296611968, -18.476036115539678, 3.656197776056986, -14.37541672875162, 6.088944000170918], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.348376151454952, -31.63134632719669, -18.81122397942184, -31.819016330188493, -48.99425420635736, -56.329410820568135, -26.847843170842975, -44.689944093139296, -11.192118017642427, -21.39712887799427, -11.65203553571477, -28.017562863687928, -29.18591096707006, -35.5893971270219, -50.38375100539815, -21.485330451400444, -20.06087494894579, -28.20459775303214, -25.55661534560541, -16.27554649738013, -44.75310358965354, -15.337397928319305, -39.18454344238874, -28.32555580836448, -37.27118034896422, -22.588862149457697, -19.24786088108891, -9.165305359115496, -27.701474957439167, -26.95531996957918, -28.62543380883737, -31.241661178028867, -39.02263499693576, -16.76014993217915, -51.9647734550944, -7.716417532759185, -26.610197018092304, -14.824266785933277, -11.283115062269397, -27.366603728068956, -25.099506831189487, -11.92219554421792, -6.9118823629399495, -10.474542835575674, -22.41051191519324, -24.66557352006521, -15.199425099900719, -12.968975661250802, -19.455557572773895, -24.055751766126352, -14.921315961753939, -11.629712677427204, -23.602919466124124, -16.332624835317443, -11.469045010396531, -22.028709736524835, -19.14648752873977, -19.876416117878712, -18.55644359021785, -32.49243270159584, -42.996607189774, -30.86834403155217, -22.522592977063834, -7.452784162693992, -21.5118017205559, -19.57298215026763, -41.151137905351085, -45.76215359529774, -22.190343898403754, -38.846886663492334, -13.839465306164229, -32.03439649074558, -16.226975666426455, -5.210100982425731, -38.117761322801115, -13.615762957811537, -26.44794059280603, -17.196277701665423, -27.869913411349454, -26.02723992566189, -30.027814476633104, -7.373591700734304, -9.163575268342793, -48.85978250383499, -39.85520274152253, -28.325137723516193, -33.56027340426734, -32.363480190452776, -44.26311246130072, -29.023671988946138, -31.640274303644613, -15.943856389894849, -35.631534317930544, -16.196370603023254, -39.883364351229204, -9.317681810982675, -8.324990916592714, -43.76401966643026, -31.728383105036343, -31.606351482998747, -8.886919281100777, -47.41830956931603, -28.6127231506831, -35.97972394980915, -6.4596654844094745, -22.11727008402169, -10.331624258662043, -34.00719054375876, -32.665591187198174, -37.8775189045358, -18.6533714440238, -25.00987463915667, -28.769350831586127, -36.62873020560722, -10.181799309964214, -35.13216791478117, -20.947387539483344, -20.86976033681924, -44.49663830277279, -22.856350312372186, -45.55837938203053, -28.368869505743522, -8.634751552490348, -74.54357630499766, -20.809589387060466, -26.670191824600334, -12.786513170364122, -51.8036971177321], "policy_policy_agent__reward": [-5.727902054670055, -5.727902054670055, 20.42836437463201, 20.42836437463201, -4.532980894927364, -4.532980894927364, 23.896810937089285, 23.896810937089285, 25.46899899929992, 25.46899899929992, 37.62146188381517, 37.62146188381517, 9.868206911710098, 9.868206911710098, 25.258477832094595, 25.258477832094595, -9.232094300397362, -9.232094300397362, 0.0017200653054091353, 0.0017200653054091353, -7.455376901433473, -7.455376901433473, -2.1997617730678907, -2.1997617730678907, 17.940757712421505, 17.940757712421505, 22.683218125669892, 22.683218125669892, 26.949636149199755, 26.949636149199755, -9.521705190414673, -9.521705190414673, 8.72737275752669, 8.72737275752669, 5.445821699266465, 5.445821699266465, 0.4266802026501785, 0.4266802026501785, 9.908383968335828, 9.908383968335828, 27.01326261651776, 27.01326261651776, 2.8024036730439654, 2.8024036730439654, 24.370042837192656, 24.370042837192656, 14.095006111789704, 14.095006111789704, 24.503497725354876, 24.503497725354876, 5.849342802716298, 5.849342802716298, 7.7727808927205695, 7.7727808927205695, 0.709225246820453, 0.709225246820453, 16.633605214088206, 16.633605214088206, 0.4046951397146199, 0.4046951397146199, 19.98702207185671, 19.98702207185671, 21.39701087216151, 21.39701087216151, 23.09807076673975, 23.09807076673975, 2.8777543079802106, 2.8777543079802106, 37.87735468146377, 37.87735468146377, -5.927574854263521, -5.927574854263521, 4.413144892740268, 4.413144892740268, 1.4048848506685543, 1.4048848506685543, -16.534871493513748, -16.534871493513748, 20.855573033406564, 20.855573033406564, 11.832992603513905, 11.832992603513905, 2.5398725614950632, 2.5398725614950632, -5.920994098690922, -5.920994098690922, -8.197494290017483, -8.197494290017483, -24.69728861716062, -24.69728861716062, 4.1644706414924535, 4.1644706414924535, 3.112989131454933, 3.112989131454933, 2.93848962617049, 2.93848962617049, -5.396286350098367, -5.396286350098367, 5.849106293853061, 5.849106293853061, 5.535442206331484, 5.535442206331484, -0.7792321342053874, -0.7792321342053874, -4.018742081229913, -4.018742081229913, -8.6883249311597, -8.6883249311597, -0.997235163961132, -0.997235163961132, 7.5723476781486125, 7.5723476781486125, 6.762073123192237, 6.762073123192237, 10.7554866896054, 10.7554866896054, 1.1583465262267865, 1.1583465262267865, 22.74867785673547, 22.74867785673547, 27.184936813468852, 27.184936813468852, 12.67340465838602, 12.67340465838602, -4.070425295343149, -4.070425295343149, -1.0045143463190658, -1.0045143463190658, -3.5798938473061193, -3.5798938473061193, 5.838193491205343, 5.838193491205343, 28.078950430713814, 28.078950430713814, 32.07909785295883, 32.07909785295883, 14.030107843985094, 14.030107843985094, 25.92765133426403, 25.92765133426403, 7.359047826522528, 7.359047826522528, 18.68576732567207, 18.68576732567207, -6.926648930297235, -6.926648930297235, -6.582829099706389, -6.582829099706389, 9.214010446728645, 9.214010446728645, 6.577913960325306, 6.577913960325306, 10.75736511163939, 10.75736511163939, 11.47169208093457, 11.47169208093457, 7.75514881895089, 7.75514881895089, 8.784021006689727, 8.784021006689727, 9.890313315512655, 9.890313315512655, -1.8651867406715221, -1.8651867406715221, -6.486399334672799, -6.486399334672799, 36.51227041834346, 36.51227041834346, 20.950566743602096, 20.950566743602096, 9.63893181871488, 9.63893181871488, 22.94731631001046, 22.94731631001046, 10.922409507119795, 10.922409507119795, 26.896067659588454, 26.896067659588454, 13.020344343149874, 13.020344343149874, 10.302903784045322, 10.302903784045322, -3.819233558901139, -3.819233558901139, 8.66637834936254, 8.66637834936254, -4.330414023180378, -4.330414023180378, 27.013314658465553, 27.013314658465553, 0.7642157360448858, 0.7642157360448858, -19.34097138371217, -19.34097138371217, 6.905864206938825, 6.905864206938825, 6.40210458267077, 6.40210458267077, 11.778425884525644, 11.778425884525644, -1.8077930131356406, -1.8077930131356406, 15.59664791913611, 15.59664791913611, 8.393885459981185, 8.393885459981185, 10.952079908430264, 10.952079908430264, -5.188964200105699, -5.188964200105699, 11.984521959815623, 11.984521959815623, -5.661409321689622, -5.661409321689622, 8.899438520151785, 8.899438520151785, 18.723134336797195, 18.723134336797195, 10.78553452562491, 10.78553452562491, 6.013058449861546, 6.013058449861546, 16.065955956618936, 16.065955956618936, 18.246352406037598, 18.246352406037598, 9.79060682427028, 9.79060682427028, 1.6298142818781471, 1.6298142818781471, 14.191485911502946, 14.191485911502946, 5.120613324953543, 5.120613324953543, 11.890593209405797, 11.890593209405797, 23.082370703731712, 23.082370703731712, 12.584770399407647, 12.584770399407647, 14.479030785662328, 14.479030785662328, -4.36647571961978, -4.36647571961978, -2.9371637501791534, -2.9371637501791534, 56.09236463555867, 56.09236463555867, 1.166776635760392, 1.166776635760392, 15.163194800328661, 15.163194800328661, -0.7944517791937513, -0.7944517791937513, 28.94632055895151, 28.94632055895151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4699873905968104, "mean_inference_ms": 4.119301190420578, "mean_action_processing_ms": 0.1459693350591042, "mean_env_wait_ms": 0.8062322127345284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 35200, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"sample_time_ms": 18702.537, "sample_throughput": 171.1, "load_time_ms": 82.386, "load_throughput": 38841.678, "learn_time_ms": 631.2, "learn_throughput": 5069.712, "update_time_ms": 9.375}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9842.7265625, "policy_entropy": 4686.505859375, "policy_loss": -16.843408584594727, "vf_loss": 124131.33203125}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22748.70703125, "policy_entropy": 5122.048828125, "policy_loss": -3.6560847759246826, "vf_loss": 402182.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 35200, "num_agent_steps_sampled": 105600, "num_steps_trained": 35200, "num_agent_steps_trained": 105600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1408, "training_iteration": 11, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-06-25", "timestamp": 1712765185, "time_this_iter_s": 17.47370958328247, "time_total_s": 208.1196358203888, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256854D5E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 208.1196358203888, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.264, "ram_util_percent": 93.432}}
{"episode_reward_max": 33.10134952916091, "episode_reward_min": -64.1078463334046, "episode_reward_mean": -10.557754203729438, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -67.87867631088301, "policy_agent_": -27.409499537777137}, "policy_reward_max": {"policy_adversary_": -3.366908220679105, "policy_agent_": 41.03023386586015}, "policy_reward_mean": {"policy_adversary_": -25.42657412845013, "policy_agent_": 7.434409962360348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.126858099944503, -38.580335232095415, -13.052198587036681, -16.689700089086806, -2.5124342837125706, -39.67163551639404, -51.700429833209725, -29.037137649428555, -10.32754473557005, -6.155745115765663, -14.924084403787571, -7.586796978058232, -18.823452275815274, -33.17317119994236, -14.73690903793348, 5.2682020412296255, -15.31464357485477, -15.527057853495148, -6.208742438663812, -12.191823442753847, 13.451643411198141, -0.5864998247488962, -19.844648522750784, 7.316230045699912, 7.61789484990718, -4.474636813444347, -10.222290305024009, -1.0969245185154675, -28.094922556632458, -14.781805536123155, -28.465060979379686, -35.9480388905719, -2.490291220190602, 0.02033247172106134, -12.045112508331165, -3.588007320030857, -13.475669666489647, -2.9551327535861436, 5.463345124957685, -23.127870149443066, 16.762005130271657, 11.252982278668604, 10.771811642981781, 8.811576378850406, -0.29830139911228093, 7.396376957881833, 9.436328495461197, -13.900156276737409, 33.10134952916091, 1.701478863792682, -20.656289580942516, -50.17113918425243, -24.026217143847134, -28.004930252343698, -10.414531790039327, -17.04781024996959, -8.389828072221494, -2.682369550664233, -16.058123569968853, -0.8259829493414748, 13.526350311531994, -28.016594591317826, -13.55673040576298, -12.511774591257357, -20.58458127776034, -27.294369310263114, -2.468181402672574, -25.77068196716329, -11.141137148772419, -6.086641237646878, 12.0371915256178, -16.824173673183036, -19.79549720923013, 1.2860458079628407, -10.725862371412312, -11.369125464469503, -40.66455678927802, -8.426142378910031, -2.36464058865279, -27.648527400988947, -14.56516187517557, 7.02973249558964, -9.310043437687403, -24.71162000899198, 13.003689619682046, -2.5472065765506366, 7.193055113867227, 2.2910269525360225, -23.558905183549033, -14.119866119843323, -34.11586966588044, -49.74708657347344, -12.454728883318968, 3.6122023367436666, 15.153971618229924, 0.6874014763713943, 13.164113896946706, -10.991609684874431, -11.728628795949017, -15.450342259712777, -64.1078463334046, -24.9736387798126, -33.77618154417025, 11.574477001310768, -20.498587020927605, -23.453320724343385, -31.416007355879334, -6.838601163671931, -4.309374236407222, -44.43975674572389, 1.3619141140978632, 20.567927423629804, -8.341058474225935, 7.2416029962774555, 1.2697950105867692, -4.222064363246437, -13.027816495011601, 2.919753654115068, 8.486283413148364, -21.29186749596387, -28.81421355901377, -24.196915537013474, 6.082124663912704, 7.628250702409319, -21.194550362531537, -6.300936731610636, -11.456681603221751, 2.3419918984614805], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-22.54815585683668, -40.68611388495135, -17.360623508347956, -19.800114300596704, -11.462071612228453, -18.379933583506148, -23.997158730150055, -3.366908220679105, -7.853697996371597, -46.869247176135936, -7.9317457086061305, -20.899264221050977, -15.224092824815683, -40.50180487156542, -19.218876533975383, -28.704846534010375, -21.732498350673445, -19.22319973229892, -15.446218246585138, -12.817480011308877, -41.36711271889769, -30.25772396059537, -21.55610823310814, -40.062259494218225, -36.84644004793344, -46.8754834752157, -25.61490538929749, -26.132080920277375, -31.184376295196415, -15.261632374925746, -16.084807894642424, -32.20002495721536, -29.13688869989117, -18.105030635465898, -24.329450980868227, -17.5365111300156, -33.30081237158926, -39.19405209929104, -24.8458992007551, -41.12807321193347, -54.51349691523931, -32.82769384246704, -46.97392978173028, -17.18454438896429, -25.82023645074584, -22.4287945420156, -25.354679386251217, -20.493356700971965, -48.95911820255938, -43.148212796543014, -42.66157551780989, -26.087402909958545, -18.523464403878826, -15.870499119016014, -15.472741394625292, -27.525551068125583, -26.778538222647462, -33.757763168154234, -16.131803748966828, -27.408651077914506, -28.076365605687002, -11.605789256188245, -38.381534252000705, -12.6806036004087, -8.67274031676023, -45.15625068129024, -35.15798349877355, -19.018430144956778, -30.98106736919829, -18.611472938308083, -22.371098820054126, -11.199401736779349, -50.95382294523645, -39.107141378597206, -10.679947968849532, -33.88319950557979, -4.4970719260916034, -24.554004947955217, -15.842487329892322, -12.327983993374726, -28.34342986149759, -26.238064518722258, -10.948685693001437, -17.253449013654055, -45.88782759669539, -8.642309002897434, -24.10143008652151, -29.736318825674864, -11.249861068541396, -6.634344971157301, -8.294660399709077, -9.519403002068394, -43.03265516768331, -21.508204439917154, -37.02945649236235, -67.87867631088301, -40.60638409191299, -26.002201739855455, -27.074621349616226, -8.022921620085304, -9.28884725785036, -26.591371959790845, -38.390467676595385, -37.52484191195261, -24.096144300941628, -6.415675606702805, -7.77513334883504, -43.36397899874281, -14.256425697721761, -12.091945750420118, -35.90893567930971, -49.739500390824, -31.44535412687106, -23.231474187002664, -25.644646347847313, -23.499816232485898, -15.358204132257697, -36.95678705120715, -36.81895678701743, -17.534856806000704, -8.44896443220336, -10.524113803338208, -17.505741810248278, -46.673099859730335, -33.78714319422431, -21.11706387341995, -15.398831893380043, -20.484082221644318], "policy_policy_agent__reward": [7.7106488784460865, 7.7106488784460865, 1.0528893264279595, 1.0528893264279595, 2.1542124606556325, 2.1542124606556325, 1.5552071057549475, 1.5552071057549475, 4.47481866425794, 4.47481866425794, -10.645850966443955, -10.645850966443955, -13.851635551529835, -13.851635551529835, -12.835114714374726, -12.835114714374726, -1.236923369599226, -1.236923369599226, 20.35675103018514, 20.35675103018514, -3.4961693475907216, -3.4961693475907216, 6.656233621496375, 6.656233621496375, -1.7996797254998032, -1.7996797254998032, 3.6643168358115275, 3.6643168358115275, 2.2409837480209474, 2.2409837480209474, 16.986524287619996, 16.986524287619996, 3.2089273879093363, 3.2089273879093363, 1.8480709394018893, 1.8480709394018893, 4.618737903960663, 4.618737903960663, 0.3128282842775135, 0.3128282842775135, 27.40937806504792, 27.40937806504792, 14.83561206792323, 14.83561206792323, 0.85572985517868, 0.85572985517868, 23.689244769959068, 23.689244769959068, 22.23216744892031, 22.23216744892031, 21.20042333088568, 21.20042333088568, 7.696307542136742, 7.696307542136742, 12.517578200880951, 12.517578200880951, 1.5447268692819751, 1.5447268692819751, 0.23991341940129074, 0.23991341940129074, -6.190126542368632, -6.190126542368632, -1.8740069666782786, -1.8740069666782786, 13.32329873985028, 13.32329873985028, 9.062681553593478, 9.062681553593478, 6.142169236268528, 6.142169236268528, 6.974251904992371, 6.974251904992371, 9.91257135254981, 9.91257135254981, 18.119459672852457, 18.119459672852457, 15.15462216285639, 15.15462216285639, 9.0001015312452, 9.0001015312452, 35.63775102275548, 35.63775102275548, 22.040338060567827, 22.040338060567827, 28.872870712356033, 28.872870712356033, 12.998060383907346, 12.998060383907346, 12.760967525816778, 12.760967525816778, 14.912585749948716, 14.912585749948716, 17.395503940856212, 17.395503940856212, 3.296600212117282, 3.296600212117282, 41.03023386586015, 41.03023386586015, 22.424845830167854, 22.424845830167854, 11.002642968433683, 11.002642968433683, -12.041868137146938, -12.041868137146938, -2.7513763699841483, -2.7513763699841483, -6.0672155666638385, -6.0672155666638385, 2.5291048022929834, 2.5291048022929834, 5.238870409077994, 5.238870409077994, 9.194355075212986, 9.194355075212986, 15.537696808744998, 15.537696808744998, 0.036840089498982154, 0.036840089498982154, 13.291334064286518, 13.291334064286518, 20.801357958609497, 20.801357958609497, -8.205402667564787, -8.205402667564787, 12.412401923118859, 12.412401923118859, 0.08441450457567534, 0.08441450457567534, -5.95592048050005, -5.95592048050005, 8.930940685513567, 8.930940685513567, 16.344901048050485, 16.344901048050485, -3.376125911103256, -3.376125911103256, 9.919965110212935, 9.919965110212935, 6.262415850330603, 6.262415850330603, 17.204145172835954, 17.204145172835954, -2.8123859682018484, -2.8123859682018484, 15.579162868003147, 15.579162868003147, 20.196593593280028, 20.196593593280028, -0.02295720128138945, -0.02295720128138945, 11.257037020555144, 11.257037020555144, -18.083742431593198, -18.083742431593198, 8.063931284522592, 8.063931284522592, 6.738923370619766, 6.738923370619766, -7.660271703807111, -7.660271703807111, 6.889133993161012, 6.889133993161012, 16.633898507155948, 16.633898507155948, 0.819321127657016, 0.819321127657016, -3.7290854976689625, -3.7290854976689625, 29.44575860818872, 29.44575860818872, 3.047551213173398, 3.047551213173398, 15.647242600194375, 15.647242600194375, 16.01367288910544, 16.01367288910544, -6.154522057503821, -6.154522057503821, -3.7427605743430132, -3.7427605743430132, -12.910604633085681, -12.910604633085681, -20.113841785702526, -20.113841785702526, 15.288963142182174, 15.288963142182174, 12.56020338833041, 12.56020338833041, 26.091714055296134, 26.091714055296134, 34.283038893627214, 34.283038893627214, 26.88524899442986, 26.88524899442986, 7.5052960274905125, 7.5052960274905125, 7.672996276833604, 7.672996276833604, -3.713710319813733, -3.713710319813733, -27.409499537777137, -27.409499537777137, 0.8088665899891243, 0.8088665899891243, 2.3071430662125687, 2.3071430662125687, 24.549659456631694, 24.549659456631694, 1.7987786400070123, 1.7987786400070123, -8.51882255882029, -8.51882255882029, -11.820437003522144, -11.820437003522144, 18.262688917535442, 18.262688917535442, 4.973525730657268, 4.973525730657268, -16.173905497651887, -16.173905497651887, 18.635424896703782, 18.635424896703782, 35.153713907226894, 35.153713907226894, 11.552147826322564, 11.552147826322564, 15.236538591640059, 15.236538591640059, 13.457220679217038, 13.457220679217038, 9.638875934619733, 9.638875934619733, 1.1651938186230488, 1.1651938186230488, 19.938270352661114, 19.938270352661114, 22.652620100082892, 22.652620100082892, -1.8785053449815778, -1.8785053449815778, -10.182624563405211, -10.182624563405211, -6.8364008668376375, -6.8364008668376375, 11.793933237080491, 11.793933237080491, 27.150675281069827, 27.150675281069827, 6.296296415846385, 6.296296415846385, 7.408063570904656, 7.408063570904656, 1.9710751450791493, 1.9710751450791493, 11.4130370600529, 11.4130370600529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.468585538428288, "mean_inference_ms": 4.098003144866583, "mean_action_processing_ms": 0.14417991207054556, "mean_env_wait_ms": 0.8016419886909442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"sample_time_ms": 18305.232, "sample_throughput": 174.813, "load_time_ms": 79.696, "load_throughput": 40152.622, "learn_time_ms": 612.749, "learn_throughput": 5222.368, "update_time_ms": 9.068}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10057.521484375, "policy_entropy": 4552.968017578125, "policy_loss": -19.14506435394287, "vf_loss": 102364.83203125}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22171.435546875, "policy_entropy": 5117.369140625, "policy_loss": -3.4566292762756348, "vf_loss": 386160.21875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 115200, "num_steps_trained": 38400, "num_agent_steps_trained": 115200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1536, "training_iteration": 12, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-06-43", "timestamp": 1712765203, "time_this_iter_s": 17.696399688720703, "time_total_s": 225.8160355091095, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256854D50D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 225.8160355091095, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.676, "ram_util_percent": 93.80799999999999}}
{"episode_reward_max": 24.772079462678363, "episode_reward_min": -63.277645443434785, "episode_reward_mean": -9.633987658975188, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -61.9496140108905, "policy_agent_": -25.340674785176105}, "policy_reward_max": {"policy_adversary_": -5.356579520596988, "policy_agent_": 31.08772557277546}, "policy_reward_mean": {"policy_adversary_": -24.187522691941, "policy_agent_": 7.276767516482904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3366622184677834, -63.277645443434785, -16.594599401758526, -12.443303618628438, -19.704138237001146, -8.27590810992622, -18.277601957497197, 7.055411794002799, -6.417898318650402, 15.968154704184645, -9.852458292493568, -21.101429887687175, -34.70458177906111, -1.4570015866259767, -16.847962479715196, -19.812059888047916, 10.862610163169467, -6.518966099097655, 4.156068848816642, -10.631053073081274, -2.1103156463488086, 8.160281180930555, -16.001660453999676, -13.928419708424073, -9.18984615506867, -3.805066315459406, -33.788074996831355, 3.6094714655076716, -17.717984228348843, -13.27566050883139, -7.761854490828593, -57.9433293371218, -1.2973854099870068, -16.49042245372258, -14.962848645217662, -0.3881835158907969, -5.755341845486214, -18.935729835770232, 2.655108200573288, -6.539317435149295, -21.03468742987905, -10.399915901309509, -12.00967467934815, -21.144401446732775, -2.5730467405740516, -11.515058614982427, -55.7268949392077, 5.022570805387132, -29.59583809648641, -9.307024570798013, -15.70124455875496, -22.629207660652714, -23.087675271934717, -9.78936534541911, 5.892766714064611, 7.538194060498113, -5.17245262680298, -14.092221735365904, -8.50250420076971, 4.288746639936948, 7.735226097671166, 16.877482620074453, -29.782196141033786, 0.07737283739598211, -39.13268502949134, -18.62696303106621, 1.6756177002896009, -4.349430332772854, -0.9659734689328162, 3.9576676281196486, 9.28504356265326, -13.858287674456243, -20.14557241853199, 9.225513045175955, -2.0839817604595243, -14.048749914675396, -23.598203052973755, -4.672550195961957, -15.793404336188399, 11.879500254148885, -9.977862468503302, 0.47315743767584717, -4.296854633897798, -18.904954815397506, 3.3850224837406353, -17.019832724799393, -31.304745325443363, -13.97843309717654, -6.3584538662068475, -12.9018581156182, -10.99771547854134, -18.219805927518117, -11.553379081488897, 4.575242993924872, -27.858129762792352, 6.739411552451646, -8.246872649096936, -1.9232049790998784, -42.2828306892619, -1.7426496748082752, -9.066158099606143, -4.41742683259416, -4.201139595429382, -4.491517084142711, 1.2607338740899339, 8.055605132760775, -3.1327451333140424, 15.177366184143901, -14.111583699249238, -7.246856089309436, -13.105035157097891, -18.805102153842785, -5.190394704728421, -5.142215535236518, -7.232703174129417, 24.772079462678363, -6.612921497845383, -27.660053289988106, -2.724103442217273, -18.43893425544583, -24.884043450153793, -4.18835486336255, -13.236856249188738, -24.68210491789021, -3.5076932017873315, 7.888482793450674, -3.9136633875258804, -10.357218933382594], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.135462897471967, -12.596295873082568, -49.10697684286137, -31.628069019006162, -22.5983382024126, -16.900065373081485, -18.04927918630691, -41.04544280981699, -9.32289281554746, -33.34655133063056, -15.680793586173097, -12.153307109925304, -34.053249358839786, -22.81200006725548, -14.22831129181738, -12.339866273719776, -33.11811028596009, -22.594025640700416, -19.17613302468715, -33.797647267457236, -15.75928734561114, -31.864736587407343, -30.222776550022502, -47.82117982949987, -13.954003310099887, -58.851914409626346, -15.20328402767323, -40.426999677681174, -26.305148035296718, -29.942516854308465, -20.76983646917327, -11.191017522741602, -14.104730328020471, -5.356579520596988, -46.907922387232354, -42.28906125640467, -11.817926562060634, -16.071012440242214, -35.33212110213863, -28.817198826586175, -22.07585993789847, -8.667186442067182, -23.091209192780532, -23.693800435515733, -20.89656379126133, -13.62298198653651, -15.350352157506734, -19.20614109121986, -10.832902237477349, -24.55166841119005, -27.702186114695884, -10.305052446503653, -26.779408556875257, -15.77804744567489, -28.20354815033618, -35.28655354156957, -23.339240712624672, -14.313128005347028, -19.768985388088957, -15.488569752523928, -32.1140926082824, -34.8586346708545, -9.790059547581338, -23.236923334401595, -27.382111656804668, -7.588616090400421, -30.77295894584259, -5.631593008449071, -17.253992769267523, -23.339524839615592, -29.31357566350847, -31.210985634280124, -9.466293508806954, -43.43599795975288, -16.046590921269036, -11.437302366740692, -28.933670097475318, -33.95621911076474, -39.62875558665868, -17.04443004347678, -14.491382225509696, -31.091224808065707, -16.658972741099195, -31.29408422059977, -33.824137108348964, -26.135733402470017, -21.327800563213316, -10.450255813739602, -37.35347258538169, -29.44371537257002, -19.18389013467218, -35.14853334415787, -25.585151290655972, -20.011455151587228, -14.515106997112401, -45.69271223948913, -28.858967330773858, -14.780068462615489, -7.461816260881583, -30.144810218741103, -12.89522790680527, -48.4117157781824, -31.88367939849652, -24.516078730923393, -16.7805678422072, -30.983328935590322, -11.141506146511958, -24.7278333176612, -23.43507902538726, -28.088787642119524, -34.191492866677414, -23.56035883888097, -20.5733420275144, -27.027885669049382, -27.417949301450946, -37.40337168287255, -17.050936744510267, -13.439562305269606, -30.693651348794646, -13.033006666457071, -10.286799584495576, -61.9496140108905, -7.586867236833519, -47.17800718167809, -12.814530134159037, -29.460766083511512, -23.642096364147648, -32.2877860645801], "policy_policy_agent__reward": [4.39940033950209, 4.39940033950209, -25.340674785176105, -25.340674785176105, 16.256188720551418, 16.256188720551418, 9.592382700188862, 9.592382700188862, 1.447099982705721, 1.447099982705721, 4.312078631577633, 4.312078631577633, -0.11416138559515199, -0.11416138559515199, 24.050427301909895, 24.050427301909895, 1.452497248448531, 1.452497248448531, 24.657353017407605, 24.657353017407605, 2.914167646839766, 2.914167646839766, -4.47406138888093, -4.47406138888093, -0.3256662101106649, -0.3256662101106649, 10.677499240314752, 10.677499240314752, -1.3098255939489047, -1.3098255939489047, -3.7360968071640737, -3.7360968071640737, 21.990360224564782, 21.990360224564782, 8.037529770801381, 8.037529770801381, 11.666100936751896, 11.666100936751896, 11.583297097187986, 11.583297097187986, 6.824485849631168, 6.824485849631168, 20.012508884168945, 20.012508884168945, 7.110558048011411, 7.110558048011411, 16.946380060537898, 16.946380060537898, 2.3820785775156086, 2.3820785775156086, 27.523424047083477, 27.523424047083477, -9.292395484579078, -9.292395484579078, 22.018235571594428, 22.018235571594428, 4.293581903473933, 4.293581903473933, 8.333428172738541, 8.333428172738541, 6.503990989172339, 6.503990989172339, -23.376155907190093, -23.376155907190093, 6.403672459016733, 6.403672459016733, -5.566921466562799, -5.566921466562799, 15.972536871007346, 15.972536871007346, 20.95043887025694, 20.95043887025694, 3.031292358287211, 3.031292358287211, -1.4323586977640093, -1.4323586977640093, 18.993614651355962, 18.993614651355962, 11.138940695718443, 11.138940695718443, 0.5205862540097136, 0.5205862540097136, -0.8663647296211625, -0.8663647296211625, 5.54076725671619, 5.54076725671619, 1.274699494391474, 1.274699494391474, 9.161758525343638, 9.161758525343638, 1.0539616857770446, 1.0539616857770446, -20.18827139085049, -20.18827139085049, 12.114355948303498, 12.114355948303498, -9.381467929504536, -9.381467929504536, 7.622321920196018, 7.622321920196018, 6.000470777970463, 6.000470777970463, -6.162077607074524, -6.162077607074524, 1.8458666424702748, 1.8458666424702748, 2.99434105012789, 2.99434105012789, 17.04815743220039, 17.04815743220039, 21.412373801033848, 21.412373801033848, 9.083394042910843, 9.083394042910843, 0.11045313499056425, 0.11045313499056425, 5.633240593659624, 5.633240593659624, 9.888658196230438, 9.888658196230438, 19.924659352976786, 19.924659352976786, 25.868058645464473, 25.868058645464473, -9.99606829672623, -9.99606829672623, 11.657148085898784, 11.657148085898784, -5.875286686343349, -5.875286686343349, -5.519173470332897, -5.519173470332897, 16.224288323066094, 16.224288323066094, 0.6410813378381084, 0.6410813378381084, 8.144009650167353, 8.144009650167353, 13.64859623386762, 13.64859623386762, 19.29930961308086, 19.29930961308086, 8.67634897991194, 8.67634897991194, -5.339639454862519, -5.339639454862519, 26.330755502464417, 26.330755502464417, 6.981304580404757, 6.981304580404757, -1.305723773967358, -1.305723773967358, 2.6677335222507783, 2.6677335222507783, 14.641834457401394, 14.641834457401394, 11.917675625235137, 11.917675625235137, 14.461965148812833, 14.461965148812833, 2.256759878503196, 2.256759878503196, 15.782191122870776, 15.782191122870776, 6.181059053600697, 6.181059053600697, 6.19456470260114, 6.19456470260114, 18.604579796044803, 18.604579796044803, 4.557950338835311, 4.557950338835311, -4.988472381115019, -4.988472381115019, -1.7640886417184691, -1.7640886417184691, 15.497509359587422, 15.497509359587422, 8.270928628475911, 8.270928628475911, 4.0930873280654225, 4.0930873280654225, 8.464363708319874, 8.464363708319874, 7.015886104583542, 7.015886104583542, 12.293349072756053, 12.293349072756053, -6.671511382839977, -6.671511382839977, 26.216061895970384, 26.216061895970384, 10.306047340838461, 10.306047340838461, 6.428431741757806, 6.428431741757806, -17.410507214190158, -17.410507214190158, 14.201080271966415, 14.201080271966415, 1.9145349035995622, 1.9145349035995622, 21.99714447279412, 21.99714447279412, 13.841269901533565, 13.841269901533565, 10.012280823390343, 10.012280823390343, 9.020650858148565, 9.020650858148565, 19.51946703417555, 19.51946703417555, 4.004380506598957, 4.004380506598957, 19.95259975090256, 19.95259975090256, 4.661747663069006, 4.661747663069006, 10.42096577640504, 10.42096577640504, 10.543228854789765, 10.543228854789765, 2.3776283425190954, 2.3776283425190954, 7.691473661392991, 7.691473661392991, 10.942835066906431, 10.942835066906431, 10.092623063660763, 10.092623063660763, 31.08772557277546, 31.08772557277546, 5.2190076233324465, 5.2190076233324465, -7.110245492359251, -7.110245492359251, 13.984773953288691, 13.984773953288691, -2.7029637944943907, -2.7029637944943907, -7.298621932829107, -7.298621932829107, 28.880629573763972, 28.880629573763972, -2.824994506177608, -2.824994506177608, 11.247951131893933, 11.247951131893933, 4.653418466185853, 4.653418466185853, 18.674624438481093, 18.674624438481093, 9.864216488310882, 9.864216488310882, 10.965283565598748, 10.965283565598748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4663107667455639, "mean_inference_ms": 4.077586527985537, "mean_action_processing_ms": 0.14430564033455304, "mean_env_wait_ms": 0.7985563897842402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 41600, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"sample_time_ms": 18089.675, "sample_throughput": 176.896, "load_time_ms": 83.479, "load_throughput": 38332.961, "learn_time_ms": 619.11, "learn_throughput": 5168.711, "update_time_ms": 9.364}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8758.76171875, "policy_entropy": 4499.9033203125, "policy_loss": -21.948031425476074, "vf_loss": 82466.890625}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22076.740234375, "policy_entropy": 5105.044921875, "policy_loss": -2.3943233489990234, "vf_loss": 344913.03125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 41600, "num_agent_steps_sampled": 124800, "num_steps_trained": 41600, "num_agent_steps_trained": 124800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1664, "training_iteration": 13, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-07-01", "timestamp": 1712765221, "time_this_iter_s": 17.764457941055298, "time_total_s": 243.5804934501648, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256854D5DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 243.5804934501648, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.956000000000003, "ram_util_percent": 93.99600000000001}}
{"episode_reward_max": 32.5625501751362, "episode_reward_min": -68.1704385417093, "episode_reward_mean": -10.124439071057271, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -59.58300259995938, "policy_agent_": -27.536275538976916}, "policy_reward_max": {"policy_adversary_": -5.991082003770886, "policy_agent_": 42.247366311936965}, "policy_reward_mean": {"policy_adversary_": -24.942887548557323, "policy_agent_": 7.409224238750026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.455164149815828, 32.5625501751362, -20.431169345965053, -0.1991739535837922, 13.40505509854265, -1.446710897729651, -8.780333249890122, -19.96138738013597, -20.36661264966481, -68.1704385417093, 21.43594548195055, -6.4871384781022225, 25.995250257340324, -18.239613996332693, 10.905946568250037, -11.41084627064878, 11.884087317037872, 5.417609046539054, -18.531636835507786, 15.718660433699043, -17.17509416385026, -13.364608480784065, -1.0890871425182476, 4.328216202825303, -25.507777287858044, -32.40063067969143, -5.866609102911116, -19.598426757349277, -1.5121408308673472, -0.6663891717461956, -28.001998907324666, -8.882422531293388, -4.349416283630305, 0.5891296523986045, -11.733995498207758, -12.544640763342752, -18.828759761023566, -24.08977025250403, -21.424595777615416, -22.666259303663534, 7.105073479139224, -19.513003095313707, 14.24038705070695, -15.481923561421855, -6.3579473799597395, -3.8025851859810658, 0.2834811477541024, -22.991659163262145, -20.996681630676576, -29.123444038624537, 2.1048405367305483, 16.709292223005068, -24.21082823638502, -8.209738955844601, -12.449749083156684, 8.113756297607704, -14.962916116248536, -14.701091736943557, -19.620564632362797, -2.979597832485716, -4.0627583542314545, -3.3764231056013516, -15.434604827005671, 4.061821128694286, -25.37224528577841, -12.398136384065667, -8.965295261361193, -33.70170367207397, -0.4215838162700445, -16.08448005039501, -17.1075327054418, -8.80336121066701, -0.06929253326147, -3.0526593731392557, -38.12700861005528, -39.46495208848327, -0.0585458527102074, -1.132432387171776, -34.824215321865786, -5.656798415990051, -17.543768975668403, -23.374788334455697, 12.769922965022012, -33.1142190061819, -34.240245195468034, -20.225172377247876, -3.700015927776263, -31.06810528526509, -2.8767477184908588, -5.772937029119699, -5.659394583812192, -60.47976385512659, 19.283917738523225, 3.1498922031246983, 1.4129043594731563, 9.570821426163656, -6.54873599352233, -47.6105989130691, -21.342771835884953, 16.959152048034895, -14.444884705982767, 3.2199550690464767, 2.9995605615839978, -27.35675027241145, -6.55378075722887, -17.911145939686616, -11.267207234170726, 6.048032897940017, -14.44719324333262, -14.94480528475773, -7.125326688658067, -13.458581078115184, -17.14267082847534, -5.47361567923922, -24.961368651642914, -11.255319562846399, -6.7460391925326535, -49.461015190257726, -4.97290192957866, -6.503756572766822, 1.9977821309726917, -4.942846971957165, 10.63371722403582, -22.83039830508749, -8.45528781492135, 1.1864533640984, -24.023167090414912, -10.397807105682821], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-23.644482523422845, -51.93218244873772, -14.391900027038895, -27.278834548886564, -53.16821908048463, -10.315705635681676, -6.204897229958052, -14.074856242914775, -46.8337953481755, -13.097887463755475, -53.50743162597485, -36.720314915504346, -43.85346659824933, -13.865751841048464, -36.61062724988274, -17.617247673246492, -28.374322152773104, -25.856763870582977, -19.746397403272912, -32.95498617734676, -29.131655638126556, -24.19127177828243, -14.310431336571446, -18.8470327445911, -14.210477818697457, -26.047242178325696, -20.18638262266318, -10.719209497130583, -27.224157448574463, -15.528421866412023, -17.196807566279077, -28.586874785339965, -25.37960657593792, -18.34140539509744, -16.442714310849375, -25.362373168389155, -10.593497241635202, -8.088239831730743, -14.001559895444638, -20.65182797837428, -40.42887945248372, -17.67111912599594, -38.77712391007649, -27.832402105500744, -10.09536717689395, -10.663563035759175, -43.098331637223964, -17.225781818301368, -38.04586428776266, -6.012026429652816, -35.390183026401324, -45.27228602394638, -25.418078726692436, -35.76360834785158, -11.24207837419495, -31.17827945716889, -25.150358257675432, -29.329943167148016, -15.39630904935197, -24.64012555690346, -22.586049082462523, -43.30668414075345, -41.31615732210032, -31.8709345386984, -25.553008454985246, -9.066986959574981, -40.21237278056616, -5.991082003770886, -22.113369962296563, -26.80180978677759, -15.233000601961841, -23.793508446241237, -25.999034988800858, -38.71721426308906, -9.871349629310814, -12.523895373564562, -53.85053688629923, -8.644352779345084, -6.370829143330912, -16.47209795426479, -17.654590935323363, -10.251586605714017, -43.704662254443065, -12.135280803380095, -7.338761429364942, -7.436853262249294, -17.10515779962677, -20.143570146789223, -18.506277372055102, -16.968330808204325, -31.054764450914064, -20.273082536485695, -41.897694921394496, -20.2926797288199, -21.604946988655698, -31.23547583171038, -19.460807621216272, -18.812217588421515, -26.365477705171127, -40.111176477132254, -18.5008822618119, -32.86361905133406, -57.71312271664815, -17.832856956805163, -29.903547280772507, -12.698957659220373, -27.39040817344068, -40.37924281140583, -28.01637005575472, -45.575587969761585, -23.75562139766591, -26.806557449808235, -13.635700266812258, -40.65122199927266, -32.463671084280584, -41.2920324577528, -38.732684927077166, -23.96407444909145, -19.17806711674628, -20.363380692563798, -59.58300259995938, -13.752958776791477, -41.104835841728935, -14.143884588920834, -17.918468401756453, -18.52581638793695, -22.197772523958488, -7.374621248616779], "policy_policy_agent__reward": [14.54982333661934, 14.54982333661934, 42.247366311936965, 42.247366311936965, -3.019634659463083, -3.019634659463083, 13.53983029765139, 13.53983029765139, 33.28663708951365, 33.28663708951365, 4.434497368976012, 4.434497368976012, -1.287718009966035, -1.287718009966035, -2.943265568610597, -2.943265568610597, 13.233591349255345, 13.233591349255345, -27.536275538976916, -27.536275538976916, 37.471688553962714, 37.471688553962714, 15.116588218701061, 15.116588218701061, 34.92435842779482, 34.92435842779482, -2.1869310776421216, -2.1869310776421216, 23.75828690906638, 23.75828690906638, 3.1032007012988525, 3.1032007012988525, 20.12920473490549, 20.12920473490549, 15.637186458561013, 15.637186458561013, 0.6073802838825643, 0.6073802838825643, 24.336823305522906, 24.336823305522906, 5.978280737138143, 5.978280737138143, 5.413331648749182, 5.413331648749182, 6.610672097026601, 6.610672097026601, 11.587624473708201, 11.587624473708201, -5.648649734580293, -5.648649734580293, -3.1766942506828646, -3.1766942506828646, 7.159886759876033, 7.159886759876033, -4.439608630109351, -4.439608630109351, 12.856008308853559, 12.856008308853559, 7.431016347332913, 7.431016347332913, -5.402595670522791, -5.402595670522791, 9.852226127023282, 9.852226127023282, 10.51509514615381, 10.51509514615381, 9.465267523748027, 9.465267523748027, 2.354359406320809, 2.354359406320809, 6.408866202523204, 6.408866202523204, -4.117631259694184, -4.117631259694184, -8.00076521038665, -8.00076521038665, -3.7115179410853845, -3.7115179410853845, -1.0072156626446276, -1.0072156626446276, 23.766976465811474, 23.766976465811474, -0.9209419846588813, -0.9209419846588813, 26.508755480391727, 26.508755480391727, 6.175239272039445, 6.175239272039445, 1.8687098984671056, 1.8687098984671056, 3.4304889248890555, 3.4304889248890555, 21.690906392489033, 21.690906392489033, -2.88293867248039, -2.88293867248039, 8.52459132854305, 8.52459132854305, -11.555708804485862, -11.555708804485862, 18.747511781565944, 18.747511781565944, 30.99078912347571, 30.99078912347571, 0.6036252451537021, 0.6036252451537021, 13.776934696003483, 13.776934696003483, -0.6038353544808676, -0.6038353544808676, 19.6460178773883, 19.6460178773883, 5.093721070713448, 5.093721070713448, 7.3144257151022325, 7.3144257151022325, -2.1121277915054084, -2.1121277915054084, 10.83026386220887, 10.83026386220887, 9.261645364115534, 9.261645364115534, 19.96513051757605, 19.96513051757605, 12.94077624754732, 12.94077624754732, 17.966377833696345, 17.966377833696345, 0.09038158460342338, 0.09038158460342338, -1.6655747122453426, -1.6655747122453426, 15.623538759602488, 15.623538759602488, -13.85531083415154, -13.85531083415154, 10.84589307301326, 10.84589307301326, 5.35866486819129, 5.35866486819129, -0.9372660517399787, -0.9372660517399787, 7.495073617787117, 7.495073617787117, 12.964871227769695, 12.964871227769695, 17.832277444974906, 17.832277444974906, -14.127829490372237, -14.127829490372237, -13.470528357459349, -13.470528357459349, 26.895995516794507, 26.895995516794507, 3.7559601960866535, 3.7559601960866535, -14.22669308926743, -14.22669308926743, 5.407649769137371, 5.407649769137371, 0.055410979827480666, 0.055410979827480666, -6.561600864370839, -6.561600864370839, 28.237292609732528, 28.237292609732528, -10.489469101400902, -10.489469101400902, -13.450741883051538, -13.450741883051538, -6.394159557499293, -6.394159557499293, 6.702570935925253, 6.702570935925253, -5.462267569237938, -5.462267569237938, 7.814764826782122, 7.814764826782122, 5.597696889542316, 5.597696889542316, 12.697684933550937, 12.697684933550937, -20.103340659320423, -20.103340659320423, 30.590806329958866, 30.590806329958866, 11.721285965972301, 11.721285965972301, 11.508925674064429, 11.508925674064429, 20.403148628937018, 20.403148628937018, 6.456035813846969, 6.456035813846969, -14.399190662323797, -14.399190662323797, 2.5113529346430843, 2.5113529346430843, 28.535164262583567, 28.535164262583567, 2.027998777914563, 2.027998777914563, 18.041787060190273, 18.041787060190273, 30.356341639116067, 30.356341639116067, -4.761946657803137, -4.761946657803137, 11.674883261771821, 11.674883261771821, -2.6060941402331235, -2.6060941402331235, 8.061600469634975, 8.061600469634975, 23.21363785467292, 23.21363785467292, 6.784588406211049, 6.784588406211049, 15.31539134250193, 15.31539134250193, 8.31514735450392, 8.31514735450392, 6.6739881858465235, 6.6739881858465235, -1.7534852808315406, -1.7534852808315406, 17.58880316001671, 17.58880316001671, 3.7511512163188354, 3.7511512163188354, 15.018356447453204, 15.018356447453204, 15.993322867272255, 15.993322867272255, -12.748470370583151, -12.748470370583151, 7.102582593583812, 7.102582593583812, 6.929812059898489, 6.929812059898489, 30.790392365466033, 30.790392365466033, 4.405055902417156, 4.405055902417156, 25.869276532882374, 25.869276532882374, -4.343256858083325, -4.343256858083325, 4.731590293417549, 4.731590293417549, 9.856134876017672, 9.856134876017672, -0.9126972832282145, -0.9126972832282145, -1.511592928533022, -1.511592928533022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46822390985585743, "mean_inference_ms": 4.093758828570642, "mean_action_processing_ms": 0.14486710611899695, "mean_env_wait_ms": 0.8014353925432866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44800, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"sample_time_ms": 18314.522, "sample_throughput": 174.725, "load_time_ms": 83.882, "load_throughput": 38148.937, "learn_time_ms": 622.887, "learn_throughput": 5137.366, "update_time_ms": 9.667}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10152.396484375, "policy_entropy": 4430.864013671875, "policy_loss": -35.576077461242676, "vf_loss": 101766.125}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22388.87890625, "policy_entropy": 5084.18798828125, "policy_loss": -4.515161514282227, "vf_loss": 365701.3125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44800, "num_agent_steps_sampled": 134400, "num_steps_trained": 44800, "num_agent_steps_trained": 134400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1792, "training_iteration": 14, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-07-21", "timestamp": 1712765241, "time_this_iter_s": 19.687397956848145, "time_total_s": 263.26789140701294, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000256854363A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 263.26789140701294, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.62962962962963, "ram_util_percent": 93.7111111111111}}
{"episode_reward_max": 17.40164546607325, "episode_reward_min": -53.66030835753569, "episode_reward_mean": -12.335193431341077, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"policy_adversary_": -50.59876686620906, "policy_agent_": -17.48464720128587}, "policy_reward_max": {"policy_adversary_": -6.572233631348699, "policy_agent_": 32.77351923764119}, "policy_reward_mean": {"policy_adversary_": -23.533697857896737, "policy_agent_": 5.599252213277831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0687312588752236, -0.7071574072854335, -6.632239499803723, -27.158336530475452, -28.4466560624067, -51.805550450150065, -33.19338540080719, -15.09458851588143, -15.368275825460865, -3.6860848224057605, 3.536975273948082, -10.72900763579623, 2.0818784269288586, -29.58077794571796, 3.60062088948255, -13.701545005305695, 2.966821017106849, -34.58278042345814, -12.512751231566691, -5.768224972597283, -37.778576355114886, -6.859332809096206, -10.34873049757303, -16.204562984992624, 10.381408683764976, -7.13183264071139, -6.885469155579496, -5.825880691917856, 1.8669761587602243, -47.6143609375473, -4.291733057284386, -53.66030835753569, -37.035330496685624, -2.5682374906843055, -11.461738596832372, -5.483844050421251, -11.179414867383603, -1.5211285953821276, -22.097127262059924, -1.0100798125538868, -20.635741351338346, -36.7332345456157, -30.771367603394385, -7.191001760039021, -14.516570329862148, 4.127994677579852, -8.81633804174947, -8.020207199395012, -3.495072113218676, -13.200417994479961, -11.20265036976004, 7.810468552713658, -14.522306007071583, -39.96409631046196, -31.10838267700328, -17.01056258911111, -11.470827817613213, -5.912275962384782, -18.881586085636236, -36.46293000597385, 3.1052806221047424, -15.319729444006974, -37.34407884780238, -8.705660655830872, -8.309079840485177, -17.428179221048197, -1.961781511087593, -18.000726183733, -4.767819968316223, 2.355169975634948, -12.981584745395422, -13.60077304832964, -35.26174854505314, -13.955710143630728, -18.72312974641032, 16.117986797554906, -1.6106774335740839, -9.66572668257089, -16.196512550636772, -19.113627144769332, -11.635023849159069, -8.866347158526098, -20.787894963387586, -2.057884675748822, 17.40164546607325, -9.254301291761776, 2.5855425348729235, -0.8002166753248527, -33.17786447484519, -10.816558955106947, -21.85338741182851, -19.022029957223744, 4.952572463140374, -2.4728636275014697, -19.68805142377685, 1.5086223471139752, 0.8848100551390041, -14.834721305025086, -7.811950156600201, -11.659685633567905, 5.5220090010403835, -2.256643469913003, -42.79849711779702, -14.491887436217633, -33.39049702217372, 0.348407997021396, -18.360591872756864, 4.900134987674396, 2.2169205872995716, -27.14237686015927, -2.896145831289951, -23.88537957540212, -18.999761371019986, -3.0496252814926463, -4.0347857977495805, -13.139344756273212, -3.4204491338550866, -5.169394987504207, -7.196706010713083, -6.332915508199696, -29.610358825660978, -16.36386366650768, 3.8333160459078033, -20.00174844899529, -5.4774270086476164, -26.02143889687253, -5.937177646567239, 1.4239099190208853], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-23.166087991769515, -40.96990202123361, -14.14815523412409, -12.762064661464505, -18.570025392416234, -16.836256047578345, -17.341215244488886, -25.054054329902478, -22.60818496753787, -26.531990706839665, -16.113259213040983, -20.075555843263928, -11.750730099850841, -19.571512981859925, -26.496272828695364, -24.435515774977198, -37.374194760833554, -26.39460907892562, -17.033305945504083, -26.243841068062995, -15.506888476799258, -11.904196385489087, -12.212330114712268, -19.999040023546673, -34.06517856375164, -45.445046778638925, -15.582150007354189, -17.01043155448122, -21.42685122727128, -21.205796344864947, -32.24515778021082, -38.743207968783345, -14.411088867860737, -39.016146556904154, -27.94155703146234, -16.696896295186296, -7.59905325932875, -40.118173217399104, -49.55757353169243, -15.254058689432771, -16.425133838206587, -8.615246760441904, -8.978614530706045, -14.821580734141671, -8.716846200679365, -23.951221497456284, -11.33478730041541, -13.924741074488482, -13.991947382116662, -39.03558962785835, -14.603300659126946, -39.54069054194388, -14.446885123715418, -25.60849728643966, -11.973332428633883, -12.052480816019735, -22.616946162910395, -19.02131905467208, -20.541160561926578, -39.943782367830806, -25.02079844460514, -20.041651966372488, -12.412157517778233, -25.373231808191917, -39.96537716178868, -20.579325354133875, -22.1881562245671, -16.835249954374937, -32.87355071809455, -47.514006245741484, -39.14095904893968, -28.81480775152316, -16.243433669594474, -41.74344025742214, -29.67619407782028, -49.42905167772748, -29.32587942687414, -25.711501626020063, -14.711492354929574, -17.04781403796381, -12.398966050941242, -25.66900351459943, -15.35518055789038, -11.702783100945448, -48.10607833025689, -15.68888522611228, -33.68803789258665, -42.7094702663901, -50.59876686620906, -19.789095639157907, -34.966750697112445, -40.345556507814365, -18.77459401714576, -35.91849948185089, -7.897607872989741, -28.560990744410372, -33.74605106139846, -21.74493817746813, -17.985671632350524, -16.812467782963463, -25.712390192123575, -29.51265958453697, -24.59231022559002, -8.006588047844126, -7.8290870159973664, -17.981096160914863, -16.566298169592024, -47.72500174064939, -26.752498528877954, -24.517772703924145, -18.50294906225394, -12.85124756707494, -19.72478400627559, -20.062122680692053, -12.797280525113909, -23.50454255176893, -22.39577398767907, -35.76965695858039, -34.384108216756, -17.659939137968937, -6.572233631348699, -13.567443724205546, -43.155563311262306, -10.626807354332366, -16.683214386003314, -34.50514166281427, -19.0218095962662, -14.663869518008639], "policy_policy_agent__reward": [13.117409625322368, 13.117409625322368, 20.131372306974086, 20.131372306974086, 3.757957867160182, 3.757957867160182, -7.198135934505478, -7.198135934505478, -4.938315334995223, -4.938315334995223, -17.48464720128587, -17.48464720128587, -7.926085078159145, -7.926085078159145, 4.979732907010525, 4.979732907010525, 3.619954571038505, 3.619954571038505, 11.422952942216952, 11.422952942216952, 9.825117243494528, 9.825117243494528, 4.673274103733847, 4.673274103733847, 6.916304263389851, 6.916304263389851, -5.0046324819290104, -5.0046324819290104, 15.04844685908896, 15.04844685908896, 5.366985384835754, 5.366985384835754, 20.1705078889702, 20.1705078889702, -4.094085672266251, -4.094085672266251, 2.260277356968695, 2.260277356968695, 10.237808047732855, 10.237808047732855, -11.135843939157821, -11.135843939157821, 2.5224317881964398, 2.5224317881964398, 0.9317998085696202, 0.9317998085696202, 1.8972385192770194, 1.8972385192770194, 22.223293623758305, 22.223293623758305, 19.156607068963773, 19.156607068963773, 4.348340425887348, 4.348340425887348, 5.592275431281683, 5.592275431281683, 11.646913693015751, 11.646913693015751, -13.204282296341177, -13.204282296341177, 13.97671236146322, 13.97671236146322, -7.4585501943761745, -7.4585501943761745, -11.312120814412449, -11.312120814412449, 18.223954533109925, 18.223954533109925, 8.239909217314986, 8.239909217314986, 5.606526122382524, 5.606526122382524, -1.7901808040274236, -1.7901808040274236, 19.298522311008483, 19.298522311008483, 13.730223134816253, 13.730223134816253, 7.1219894384394395, 7.1219894384394395, -2.1053037565658803, -2.1053037565658803, -14.05899389258689, -14.05899389258689, -10.896376536344174, -10.896376536344174, 3.8152894870513236, 3.8152894870513236, -2.899862064591387, -2.899862064591387, 14.039608087518069, 14.039608087518069, 1.2592246293329687, 1.2592246293329687, 2.9522669375467343, 2.9522669375467343, 5.248437634448994, 5.248437634448994, 12.917585816689193, 12.917585816689193, 1.7003251446834544, 1.7003251446834544, 23.675579547328773, 23.675579547328773, -0.03771044167808124, -0.03771044167808124, -7.1777995120111555, -7.1777995120111555, -9.56752512418469, -9.56752512418469, -2.479040886545688, -2.479040886545688, 5.573059172648594, 5.573059172648594, 6.554521546143652, 6.554521546143652, 0.829787238145171, 0.829787238145171, 1.7404261809284853, 1.7404261809284853, 14.063039533354944, 14.063039533354944, 2.3609612611827577, 2.3609612611827577, -12.465960665012064, -12.465960665012064, 8.333785576180524, 8.333785576180524, 15.828148660651753, 15.828148660651753, 1.575573066542841, 1.575573066542841, 10.113187356739754, 10.113187356739754, -0.5827381146790305, -0.5827381146790305, 14.05286537488916, 14.05286537488916, 24.934588110688214, 24.934588110688214, 13.079687151772129, 13.079687151772129, 7.607017351596766, 7.607017351596766, -9.509157437729343, -9.509157437729343, 13.893865056895702, 13.893865056895702, 5.476532165704985, 5.476532165704985, 32.77351923764119, 32.77351923764119, 13.857600996650024, 13.857600996650024, 8.022887471724585, 8.022887471724585, -0.7425100978535971, -0.7425100978535971, -1.0329065534027608, -1.0329065534027608, 0.38197110089108754, 0.38197110089108754, 8.40132817803667, 8.40132817803667, -2.716357202748604, -2.716357202748604, 4.822449212598311, 4.822449212598311, 32.75386189816508, 32.75386189816508, 3.217291967175256, 3.217291967175256, 18.136790213729785, 18.136790213729785, 20.954626795532626, 20.954626795532626, 8.710451195681935, 8.710451195681935, 4.486268342025476, 4.486268342025476, 6.556681642641976, 6.556681642641976, 10.661763275295307, 10.661763275295307, 11.863583240143063, 11.863583240143063, 16.72281792717471, 16.72281792717471, -5.895221775393557, -5.895221775393557, 15.034806545762173, 15.034806545762173, 17.315430558268737, 17.315430558268737, 3.455108436221526, 3.455108436221526, 5.086860737875165, 5.086860737875165, 2.576391074697779, 2.576391074697779, 15.617199596581974, 15.617199596581974, 13.628008057311984, 13.628008057311984, -9.103093446103497, -9.103093446103497, -3.2426496941867557, -3.2426496941867557, -12.78070500308818, -12.78070500308818, 9.164752078968128, 9.164752078968128, -0.897146851582416, -0.897146851582416, 26.312568364161887, 26.312568364161887, 14.484709558088763, 14.484709558088763, -1.3123020781175598, -1.3123020781175598, 7.803401615481996, 7.803401615481996, -5.517066004163593, -5.517066004163593, 0.36251131762780386, 0.36251131762780386, 8.506248699599706, 8.506248699599706, 4.381247363682164, 4.381247363682164, 5.1825988977478605, 5.1825988977478605, 9.487662426911994, 9.487662426911994, 15.3001309855381, 15.3001309855381, 13.593701103021461, 13.593701103021461, 5.663511814884621, 5.663511814884621, -11.519062597156143, -11.519062597156143, -1.39820997115107, -1.39820997115107, 23.494439678585053, 23.494439678585053, -4.687470547331458, -4.687470547331458, 5.60289368867785, 5.60289368867785, 4.24185138297087, 4.24185138297087, 6.54231597484948, 6.54231597484948, 8.043889718514762, 8.043889718514762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46614530605513954, "mean_inference_ms": 4.082476908220719, "mean_action_processing_ms": 0.14481387837017928, "mean_env_wait_ms": 0.7984888747082095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 18276.204, "sample_throughput": 175.091, "load_time_ms": 83.783, "load_throughput": 38194.087, "learn_time_ms": 626.48, "learn_throughput": 5107.902, "update_time_ms": 9.468}, "info": {"learner": {"policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7185.0078125, "policy_entropy": 4399.887939453125, "policy_loss": -41.42395210266113, "vf_loss": 65831.171875}, "model": {}, "custom_metrics": {}}, "policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20774.65625, "policy_entropy": 5066.64453125, "policy_loss": -3.2589821815490723, "vf_loss": 313351.375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 144000, "num_steps_trained": 48000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1920, "training_iteration": 15, "trial_id": "cb9b1_00000", "experiment_id": "9bdc0f28c39d4a10bd9747ece259eb3e", "date": "2024-04-11_01-07-39", "timestamp": 1712765259, "time_this_iter_s": 17.962587118148804, "time_total_s": 281.23047852516174, "pid": 10872, "hostname": "DESKTOP-6P4N9VB", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": false, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "gru", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "coma", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.COMATorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000025685511B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 281.23047852516174, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.700000000000003, "ram_util_percent": 93.83076923076925}}
